import{r as i,m as e,Q as se,S as ae,u as ne,s as re,q as le,T as V,U as oe,V as B,o as G,W as ie,X as ce,x as Z,Y as K}from"./index-D947kQi8.js";import{u as me}from"./useRefreshUser-yyrxJGJN.js";import{c as de,X as pe}from"./x-DKu83ede.js";const xe="/assets/company-logo-baJq8U9U.png";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],fe=de("check",ue),he=({isOpen:s,onClose:j,imageSrc:w,onCropComplete:E,aspectRatio:g=1})=>{const[p,_]=i.useState({x:0,y:0}),[m,L]=i.useState(1),[c,I]=i.useState(!1),[D,M]=i.useState({x:0,y:0}),U=i.useRef(null),k=i.useRef(null),C=i.useRef(null);i.useEffect(()=>{if(s&&w){const a=new Image;a.onload=()=>{C.current=a,$()},a.src=w}},[s,w,p,m]);const $=()=>{const a=U.current,x=C.current;if(!a||!x)return;const n=a.getContext("2d"),y=k.current;if(!y)return;const l=y.offsetWidth,u=y.offsetHeight;a.width=l,a.height=u,n.fillStyle="rgba(0, 0, 0, 0.5)",n.fillRect(0,0,l,u);const S=Math.min(l/x.width,u/x.height)*m,d=x.width*S,b=x.height*S,f=(l-d)/2+p.x,F=(u-b)/2+p.y;n.save(),n.globalCompositeOperation="destination-out";const h=Math.min(l,u)*.7,o=(l-h)/2,N=(u-h)/2;g===1?(n.beginPath(),n.arc(l/2,u/2,h/2,0,Math.PI*2),n.fill()):n.fillRect(o,N,h,h/g),n.restore(),n.globalCompositeOperation="destination-over",n.drawImage(x,f,F,d,b),n.globalCompositeOperation="source-over",n.strokeStyle="#fff",n.lineWidth=2,g===1?(n.beginPath(),n.arc(l/2,u/2,h/2,0,Math.PI*2),n.stroke()):n.strokeRect(o,N,h,h/g)},R=a=>{I(!0),M({x:a.clientX-p.x,y:a.clientY-p.y})},O=a=>{c&&_({x:a.clientX-D.x,y:a.clientY-D.y})},W=()=>{I(!1)},q=i.useCallback(async()=>{const a=C.current,x=k.current;if(!a||!x)return;const n=x.offsetWidth,y=x.offsetHeight,l=Math.min(n/a.width,y/a.height)*m,u=a.width*l,S=a.height*l,d=(n-u)/2+p.x,b=(y-S)/2+p.y,f=Math.min(n,y)*.7,F=(n-f)/2,h=(y-f)/2,o=document.createElement("canvas");o.width=f,o.height=f/g;const N=o.getContext("2d"),T=(F-d)/l,X=(h-b)/l,z=f/l,Y=f/g/l;N.drawImage(a,T,X,z,Y,0,0,f,f/g),o.toBlob(H=>{E(H),j()},"image/jpeg",.95)},[p,m,g,E,j]);return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:"Crop Image"}),e.jsx("div",{ref:k,className:"relative h-96 bg-gray-100 dark:bg-gray-700 rounded-lg mb-4 overflow-hidden cursor-move",onMouseDown:R,onMouseMove:O,onMouseUp:W,onMouseLeave:W,children:e.jsx("canvas",{ref:U,className:"w-full h-full"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zoom"}),e.jsx("input",{type:"range",min:1,max:3,step:.1,value:m,onChange:a=>L(parseFloat(a.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[e.jsx(pe,{size:16})," Cancel"]}),e.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-[#6C5DD3] text-white rounded-lg",children:[e.jsx(fe,{size:16}),"  Save"]})]})]})})}):null},ge=ae("pk_test_51R6uLuGhmABE4SukbmgqsLITna4D57Ittag620AxGwm1ckI0oeYBXvNUBO9w4WhygDlp3sWd7ldWiZlGbR8jzxXk00N3jUSXPv"),ye=()=>{const{user:s,role:j}=ne(t=>t.user);re();const{showSnackbar:w}=le(),E=me(),g="https://phplaravel-1547671-6035260.cloudwaysapps.com/storage",[p,_]=i.useState(!1),[m,L]=i.useState(!1),[c,I]=i.useState(!(s!=null&&s.company_name)||!(s!=null&&s.sub_domain)),[D,M]=i.useState(null),[U,k]=i.useState(null),[C,$]=i.useState(null),[R,O]=i.useState(null),[W,q]=i.useState(!1),[a,x]=i.useState(null),[n,y]=i.useState(null),{register:l,handleSubmit:u,reset:S,formState:{errors:d}}=V({defaultValues:{first_name:"",last_name:"",email:"",phone:""}}),{register:b,handleSubmit:f,reset:F,control:h,formState:{errors:o}}=V({defaultValues:{company_name:"",sub_domain:"",company_email:"",company_phone:"",company_website:""}});i.useEffect(()=>{s&&(S({first_name:s.first_name||"",last_name:s.last_name||"",email:s.email||"",phone:s.phone||""}),F({company_name:s.company_name||"",sub_domain:s.sub_domain||"",company_email:s.company_email||"",company_phone:s.company_phone||"",company_website:s.company_website||""}),s.profile_image&&M(s.profile_image),s.company_logo_url&&k(s.company_logo_url))},[s]);const N=(t,r)=>{const v=t.target.files[0];if(!v)return;const P=new FileReader;P.onload=()=>{x(P.result),y(r),q(!0)},P.readAsDataURL(v),t.target.value=""},T=t=>{const r=new File([t],"image.jpg",{type:"image/jpeg"}),v=URL.createObjectURL(t);n==="profile"?($(r),M(v)):(O(r),k(v))},X=oe({control:h,name:"sub_domain"}),z=async t=>{try{_(!0);const r=new FormData;r.append("_method","PATCH"),r.append("first_name",t.first_name),r.append("last_name",t.last_name),r.append("phone",t.phone),C&&r.append("profile_image",C),await K(r),w("Profile updated successfully","success"),await E(),L(!1),$(null)}catch{w("Failed to update profile","error")}finally{_(!1)}},Y=async t=>{try{_(!0);const r=new FormData;r.append("_method","PATCH"),Object.entries(t).forEach(([v,P])=>{P&&r.append(v,P)}),R&&r.append("company_logo",R),await K(r),w("Company updated successfully","success"),await E(),I(!1),O(null)}catch{w("Failed to update company","error")}finally{_(!1)}},H=t=>t!=null&&t.startsWith("http")||t!=null&&t.startsWith("blob:")?t:`${g}/${t}`,J=t=>t?t.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "):"Not Assigned";function Q(){if(typeof window>"u")return"visionvivante.in";const t=window.location.hostname.split(".");return t.length>2?t.slice(1).join("."):window.location.hostname}const A=Q();function ee(t){return`https://${t!=null&&t.trim()?t.toLowerCase().trim().replace(/\s+/g,""):"your-company"}.${A}`}const te=ee(X);return e.jsx("div",{className:"min-h-screen my-5",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b dark:border-b-[#333333]",children:[e.jsx("h1",{className:"text-3xl text-black dark:text-white",children:"My Profile"}),e.jsx("button",{onClick:()=>L(t=>!t),className:"flex items-center gap-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx(B,{})," ",e.jsx("span",{children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{})," ",e.jsx("span",{children:"Edit Profile"})]})})]}),e.jsx("div",{className:"flex justify-start mt-8 ml-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:D?e.jsx("img",{src:H(D),alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(ie,{className:"w-full h-full text-[#6C5DD3]"})}),m&&e.jsxs("label",{htmlFor:"profileImage",className:"border rounded-lg px-4 py-2 text-black dark:text-white cursor-pointer",children:["Upload Image",e.jsx("input",{type:"file",id:"profileImage",className:"hidden",accept:"image/*",onChange:t=>N(t,"profile")})]})]})}),e.jsx("form",{onSubmit:u(z),children:e.jsx("div",{className:"profile-detail-form-container-main-div",children:e.jsxs("div",{className:"dark:bg-[#181818] bg-[#fff] profile-detail-form-container-wrap",children:[e.jsxs("div",{className:"w-[100%] md:w-[60%]",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"First Name"}),e.jsx("input",{type:"text",...l("first_name",{required:"First name is required"}),readOnly:!m,className:`form-control w-full ${d.first_name?"border border-red-500":""} ${m?"":"opacity-75 cursor-not-allowed"}`}),d.first_name&&m&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.first_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Last Name"}),e.jsx("input",{type:"text",...l("last_name",{required:"Last name is required"}),readOnly:!m,className:`form-control w-full ${d.last_name?"border border-red-500":""} ${m?"":"opacity-75 cursor-not-allowed"}`}),d.last_name&&m&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.last_name.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Email"}),e.jsx("input",{type:"email",...l("email"),disabled:!0,className:"form-control w-full opacity-75 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Phone Number"}),e.jsx("input",{type:"tel",...l("phone",{validate:t=>t?/^(\+44|0044|0)\s?7\d{3}\s?\d{6}$|^(\+44|0044|0)\s?(1\d{1}|2\d{1}|3\d{1}|8\d{1})\d{2}\s?\d{6}$/.test(t)||"Enter a valid UK phone number":!0}),readOnly:!m,className:`form-control w-full ${d.phone?"border border-red-500":""} ${m?"":"opacity-75 cursor-not-allowed"}`}),d.phone&&m&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.phone.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 mt-5 inline-block",children:"Role:"}),e.jsxs("div",{className:"relative opacity-75 cursor-not-allowed",children:[e.jsx("input",{type:"text",className:"form-control w-full cursor-not-allowed",value:J(j),readOnly:!0,style:{paddingLeft:"40px"}}),e.jsx("span",{className:"inline-block absolute left-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-purple",children:e.jsx(ce,{})})]})]})]}),m&&e.jsx("div",{className:"text-right mb-8 mt-5",children:e.jsx("button",{type:"submit",className:"purple-btn flex items-center gap-2 ml-auto",disabled:p,children:p?e.jsx(Z,{size:20}):e.jsx(e.Fragment,{children:" Save Profile Changes"})})})]})})}),j!=="investor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b dark:border-b-[#333333] mt-10",children:[e.jsx("h1",{className:"text-xl text-black dark:text-[#F8F8F8]",children:"Company Details"}),j!=="team"&&j!=="team-lead"&&e.jsx("button",{onClick:()=>I(t=>!t),className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx(B,{})," ",e.jsx("span",{children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{})," ",e.jsx("span",{children:"Edit Company"})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 p-5",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:e.jsx("img",{src:U||xe,alt:"Company Logo",className:"w-full h-full object-cover"})}),c&&e.jsxs("label",{className:"border rounded-lg px-4 py-2 text-black dark:text-white cursor-pointer",children:["Upload Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:t=>N(t,"company")})]})]}),e.jsxs("form",{onSubmit:f(Y),children:[e.jsx("div",{className:"dark:bg-[#181818] bg-[#fff] profile-detail-form-container-wrap",children:e.jsxs("div",{className:"w-[100%] md:w-[60%]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Name"}),e.jsx("input",{type:"text",...b("company_name",{required:"Company name is required"}),readOnly:!c,className:`form-control w-full ${o.company_name?"border border-red-500":""} ${c?"":"opacity-75 cursor-not-allowed"}`}),o.company_name&&c&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.company_name.message})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] my-2 inline-block",children:"Sub Domain"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"your-company",...b("sub_domain",{required:"Sub domain is required",pattern:{value:new RegExp("^(?!-)[a-z0-9-]{1,63}(?<!-)$"),message:"Use only lowercase letters, numbers, and hyphens (cannot start or end with hyphen)"}}),readOnly:!c,className:`form-control w-full pr-48 ${o.sub_domain?"border border-red-500":""} ${c?"":"opacity-75 cursor-not-allowed"}`}),e.jsxs("span",{className:"absolute inset-y-0 right-3 flex items-center text-gray-500 text-sm font-medium pointer-events-none",children:[".",A]})]}),o.sub_domain&&c&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.sub_domain.message}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Your app will be available at:"," ",e.jsx("strong",{className:"text-[#6C5DD3]",children:te})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Email"}),e.jsx("input",{type:"email",...b("company_email",{required:"Company email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Enter a valid email address"}}),readOnly:!c,placeholder:"Enter company email",className:`form-control w-full ${o.company_email?"border border-red-500":""} ${c?"":"opacity-75 cursor-not-allowed"}`}),o.company_email&&c&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.company_email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Phone"}),e.jsx("input",{type:"tel",...b("company_phone",{required:"Company phone is required",pattern:{value:/^(\+44|0044|0)\s?7\d{3}\s?\d{6}$|^(\+44|0044|0)\s?(1\d{1}|2\d{1}|3\d{1}|8\d{1})\d{2}\s?\d{6}$/,message:"Enter a valid UK phone number"}}),readOnly:!c,placeholder:"Enter phone number",className:`form-control w-full ${o.company_phone?"border border-red-500":""} ${c?"":"opacity-75 cursor-not-allowed"}`}),o.company_phone&&c&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.company_phone.message})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Website"}),e.jsx("input",{type:"text",...b("company_website"),readOnly:!c,placeholder:"Enter Company website",className:`form-control w-full ${c?"":"opacity-75 cursor-not-allowed"}`})]})]})}),c&&e.jsx("div",{className:"text-right mb-8",children:e.jsx("button",{type:"submit",className:"purple-btn flex items-center gap-2 ml-auto",disabled:p,children:p?e.jsx(Z,{size:20}):e.jsx(e.Fragment,{children:" Save Company Changes"})})})]})]}),e.jsx(he,{isOpen:W,onClose:()=>q(!1),imageSrc:a,onCropComplete:T,aspectRatio:1})]})})},Ne=()=>e.jsx(se,{stripe:ge,children:e.jsx(ye,{})});export{Ne as default};
