import{t as ae,q as re,u as E,r as l,aL as le,m as t,L as ne,v as ce,y as oe,x as ie,n as de,b_ as pe,c0 as xe,B as ue,D as me}from"./index-Bbk-TWcL.js";import{P as he}from"./PaginationNew-C13B61bS.js";import{A as ge}from"./index-CGxdH-oH.js";import{D as fe}from"./DeleteConfirmationModal-BVv8qqWx.js";import{A as Ae,m as be}from"./proxy-C1LgloiJ.js";const ye="data:image/png;base64,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",je=B=>{const U=ae(),{showSnackbar:A}=re(),{user:b,role:we}=E(e=>e.user),[d,L]=l.useState(0),[g,Q]=l.useState("all"),[S,w]=l.useState(!1),[O,ve]=l.useState(!1),[x,P]=l.useState([]),[v,N]=l.useState([]),[_,F]=l.useState(null),[T,Ne]=l.useState(!1),R=le.useRef(null),[u,_e]=l.useState("all"),[Fe,De]=l.useState(!1),[D,K]=l.useState(null),[ke,Ie]=l.useState(null),[M,k]=l.useState(!1),[Ce,Ee]=l.useState(!1),[V,I]=l.useState(!1),[p,q]=l.useState(),y=E(e=>e.deal.dealsTypes),[o,z]=l.useState({currentPage:1,totalPages:1,from:0,to:0,total:0,hasMorePages:!1}),[c,f]=l.useState({per_page:(o==null?void 0:o.total)>=5||(o==null?void 0:o.total)==0?5:(o==null?void 0:o.total)||1,page:1,status:"all",year:"",propertyTypeId:"",dealTypeId:"",sortColumn:"created_at",sortOrder:"desc",search:""}),j=async e=>{const a={user_id:e==null?void 0:e.user_id,property_deal_id:e==null?void 0:e.id};await me(a),U(`/deal-detail/${e.unique_id}`)},X=async()=>{var e;if(D)try{k(!0);let a=await ue(D);A((e=a==null?void 0:a.data)==null?void 0:e.message),C(),I(!1),K(null)}catch(a){console.error("Error deleting deal:",a),A("Failed to delete deal","error")}finally{k(!1)}},C=async()=>{var e,a;try{w(!0);const s={page:c.page,perPage:c.per_page,status:c.status===""?null:c.status,year:c.year===""?null:c.year,propertyTypeId:c.propertyTypeId===""?null:c.propertyTypeId,sortColumn:c.sortColumn,sortOrder:c.sortOrder};u!=="all"&&u!=="tab"&&(s.dealTypeId=c.dealTypeId);const n=await pe(s);if(n&&n.data){L((a=(e=n==null?void 0:n.data)==null?void 0:e.data)==null?void 0:a.propertyDealShares),P(n.data.data.propertyDealShares||[]);const r=n.data.data.page_context;r&&z({currentPage:parseInt(r==null?void 0:r.page)||1,totalPages:Math.ceil(parseInt((r==null?void 0:r.total_records)||0)/parseInt((r==null?void 0:r.per_page)||10)),from:(parseInt(r.page)-1)*parseInt(r.per_page)+1,to:Math.min(parseInt(r==null?void 0:r.page)*parseInt(r==null?void 0:r.per_page),parseInt((r==null?void 0:r.total_records)||0)),total:parseInt((r==null?void 0:r.total_records)||0),hasMorePages:(r==null?void 0:r.has_more_page)==="true"})}}catch{A("Failed to fetch deals. Please try again.","error")}finally{w(!1)}};l.useEffect(()=>{f(e=>({...e,status:g==="all"?"all":g,page:1}))},[g]),l.useEffect(()=>{var a,s;const e=u==="all"?1:((s=(a=y==null?void 0:y.deal_types)==null?void 0:a.find(n=>n.slug===u))==null?void 0:s.id)??null;f(n=>({...n,dealTypeId:e,page:1}))},[u]);const J=[{label:"Deals sent to me",status:"all",icon:t.jsx(ne,{className:"w-5 h-5 text-[#595959] dark:text-[#C5C5C5]"}),count:(p==null?void 0:p.total)??0},{label:"Deals interested in",status:1,icon:t.jsx(ce,{className:"w-5 h-5 text-[#595959] dark:text-[#C5C5C5]"}),count:(p==null?void 0:p.interested)??0},{label:"Deals not interested in",status:2,icon:t.jsx("img",{src:ye,alt:"Uninterested",className:"w-5 h-5 text-white dark:text-[#C5C5C5]"}),count:(p==null?void 0:p.not_interested)??0}],W=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",[H,Y]=l.useState(""),Z=e=>{const a=e.target.value;Y(a),debouncedSearch(a)},G=e=>{switch(Number(e)){case 1:return t.jsx("span",{className:"border border-[#D9F99D] rounded-xl bg-[#F7FEE7] px-2 py-1 text-xs text-[#4D7C0F] dark:bg-[#1A2E05] dark:text-[#BEF264] dark:border-[#3F6212]",children:"Interested"});case 2:return t.jsx("span",{className:"border border-[#FFE0E0] rounded-xl bg-[#FEF2F2] px-2 py-1 text-xs text-[#DE2424] dark:bg-[#371C1C] dark:text-[#FFA9A9] dark:border-[#751D1D]",children:"Not Interested"});case 0:case 3:return t.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark-text-[#CBD5E1] dark:bg-[#020617] dark:border-[#1E293B]",children:"Awaiting response"});default:return t.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F1F5F9] px-2 py-1 text-xs text-[#64748B]",children:"Unknown"})}},$=[{label:"All Status",status:"all",count:d==null?void 0:d.all,value:"all"},{label:"Interested",status:"interested",count:d==null?void 0:d.interested,value:"1"},{label:"Not Interested",status:"not_interested",count:d==null?void 0:d.not_interested,value:"2"}];l.useEffect(()=>{c.dealTypeId&&C()},[c]);const ee=e=>{const{name:a,value:s}=e.target;f({...c,[a]:s,page:1})},te=async()=>{try{const e=await xe();console.log("Data only:",e.data.data),q(e.data.data)}catch(e){console.error("Error fetching counts:",e)}};l.useEffect(()=>{te()},[]);const se=e=>{var n,r,m,h;const a=[];if(e!=null&&e.no_of_dwelling){const i=(e==null?void 0:e.deal_type_id)===2?e.no_of_dwelling>1?" Beds":" Bed":e.no_of_dwelling>1?" Bedrooms":" Bedroom";a.push(e.no_of_dwelling+i)}if(e!=null&&e.deal_type&&a.push(e.deal_type.title),(n=e==null?void 0:e.sub_category)!=null&&n.title&&a.push(e.sub_category.title),(r=e==null?void 0:e.property_type_category)!=null&&r.title&&a.push((m=e.property_type_category)==null?void 0:m.title),(h=e==null?void 0:e.exit_type)!=null&&h.title){let i=e.exit_type.title.toLowerCase();i==="sell"?i="Flip":i==="refinance"&&(i="BRRR"),a.push(i)}return a.join(",")};return t.jsxs("div",{children:[t.jsx(fe,{isOpen:V,onClose:()=>I(!1),onConfirm:X,title:"Delete Deal",isLoading:M}),t.jsxs("h1",{className:"text-3xl font-semibold text-dark dark:text-white",children:["Welcome Back, ",W(b==null?void 0:b.first_name)]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-4 p-4",children:J.map(({label:e,status:a,icon:s,count:n})=>t.jsx("div",{className:`border rounded-xl px-4 dashboard-box-col cursor-pointer ${g===a?"!bg-[#F6F7FE] border-[#AFB6F2] text-black dark:!bg-[#262145] dark:!border-[#6C5DD3] dark:!text-white":"dark:border-[#454545]"}`,onClick:()=>Q(a),children:t.jsxs("div",{className:"flex flex-col h-full py-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("p",{className:"text-[15px]",children:e}),t.jsx("div",{className:"text-[30px] text-[#595959] ",children:s})]}),t.jsxs("div",{className:"flex flex-col justify-center items-start flex-1",children:[t.jsx("span",{className:"text-[46px] font-semibold",children:n}),t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"text-[#039855]",children:"+100%"})," from last month"]})]})]})},a))}),t.jsx("h3",{className:"text-[#333333] dark:text-[#C5C5C5]",children:"Deals"}),t.jsxs("div",{className:"total-deal-table-wrapper",children:[t.jsxs("div",{className:"flex flex-col md:flex-row space-x-4 justify-between px-4 py-4 gap-4 md:gap-0",children:[t.jsxs("div",{className:"relative custom-input-w",children:[t.jsx("input",{type:"text",placeholder:"Search for deals",className:"form-control",value:H,onChange:Z,style:{paddingLeft:"40px"}}),t.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),t.jsx("div",{className:"p-1 rounded-xl",children:t.jsx("div",{children:t.jsx("ul",{className:"flex flex-nowrap justify-between items-center gap-1 deal-types-tabs-wrap text-xs sm:text-sm",children:$.map(({label:e,value:a,icon:s,count:n})=>t.jsx("li",{className:"flex-1",children:t.jsxs("button",{onClick:()=>ee({target:{name:"status",value:a}}),className:`tab-btn flex items-center justify-center gap-1 w-full ${c.status===a?"active":""}`,children:[t.jsx("span",{className:"shrink-0",children:s}),t.jsx("span",{className:"truncate",children:e}),n!==null&&t.jsx("span",{className:"ml-1 font-medium text-[#242424]",children:n})]})},a))})})})]}),S||O?t.jsx(ie,{}):t.jsx("div",{className:"overflow-x-auto dark:bg-[#222632] bg-[#EBEBEC] comparable-listing-table-wrap",children:t.jsxs("table",{className:`${x.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-[#F8F8F8] text-dark dark:text-[#F8F8F8] border dark:bg-[#242424] dark:border-[#454545]",children:[t.jsx("th",{className:"",children:t.jsx("input",{type:"checkbox",onChange:e=>{e.target.checked?N(x.map(a=>a.id)):N([])},checked:v.length===x.length&&x.length>0})}),t.jsx("th",{className:"",children:"TITLE"}),t.jsx("th",{className:"",children:"COMPANY"}),t.jsx("th",{className:"",children:"ROI"}),t.jsx("th",{className:"",children:"STATUS"}),t.jsx("th",{className:"",children:"DATE"}),t.jsx("th",{className:"",children:"ACTIONS"})]})}),t.jsx("tbody",{children:x.length>0?x.map((e,a)=>{var n,r,m,h,i;const s=e==null?void 0:e.property_deal;return t.jsxs("tr",{className:"",children:[t.jsx("td",{children:t.jsx("input",{type:"checkbox",checked:v.includes(s==null?void 0:s.id),onChange:()=>handleSelectDeal(s==null?void 0:s.id)})}),t.jsx("td",{className:"",children:t.jsx("div",{className:"line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis cursor-pointer",onClick:()=>{j(s)},children:se(s)})}),t.jsx("td",{className:"",children:t.jsx("div",{className:"line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis cursor-pointer",onClick:()=>{j(s)},children:((n=e==null?void 0:e.contact)==null?void 0:n.company_name)||"-"})}),t.jsx("td",{children:(r=s==null?void 0:s.property_deal_investment)!=null&&r.return_on_cash_investment_percentage?`${parseFloat((m=s==null?void 0:s.property_deal_investment)==null?void 0:m.return_on_cash_investment_percentage).toFixed(0)}%`:(h=s==null?void 0:s.property_deal_sa_investment)!=null&&h.net_roi_percentage?`${parseFloat((i=s==null?void 0:s.property_deal_sa_investment)==null?void 0:i.net_roi_percentage).toFixed(0)}%`:"0%"}),t.jsx("td",{className:"",children:G(e.intrust_status)}),t.jsx("td",{className:"",children:e.created_at?new Date(e.created_at).toLocaleDateString():"-"}),t.jsx("td",{className:"relative",children:t.jsxs("div",{id:`dropdown-${s==null?void 0:s.id}`,className:"flex justify-center relative",children:[t.jsx("button",{onClick:()=>F(_===(s==null?void 0:s.id)?null:s==null?void 0:s.id),className:"text-lg",children:t.jsx(de,{className:"text-[#595959]"})}),t.jsx(Ae,{children:_===(s==null?void 0:s.id)&&t.jsx(be.div,{ref:R,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:`absolute right-0 w-40 bg-white rounded shadow-lg z-10 ${T?"bottom-full mb-2":"bottom-full mt-2"}`,children:B!=="archive"&&t.jsxs("button",{onClick:()=>{j(s),F(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 text-sm dark:bg-[#121212]",children:[t.jsx(ge,{className:"mr-2"})," View"]})})})]})})]},e==null?void 0:e.id)}):t.jsx("tr",{children:t.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No shared deals available"})})})]})}),t.jsx(he,{pagination:{total:o.total,currentPage:c.page,perPage:c.per_page>o.total?o.total:c.per_page,totalPages:Math.ceil(o.total/c.per_page)},setFilters:f})]})]})},Oe=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"}));export{je as I,ye as U,Oe as a};
