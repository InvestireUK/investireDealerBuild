import{r as s,m as e,Q as ge,S as be,T as ye,U as je,u as te,s as _e,q as we,V as ae,W as ve,X as Ne,Y as se,o as ne,Z as ke,_ as Ce,x as oe,$ as Se}from"./index-C0kg02ZK.js";import{u as Fe}from"./useRefreshUser-BQcPv7M6.js";import{c as Me,X as Pe}from"./x-HoncJkzR.js";const Le="/assets/company-logo-baJq8U9U.png";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ee=Me("check",Ie),Ue=({isOpen:t,onClose:p,imageSrc:U,onCropComplete:D,aspectRatio:f=1})=>{const[g,F]=s.useState({x:0,y:0}),[_,H]=s.useState(1),[q,X]=s.useState(!1),[P,V]=s.useState({x:0,y:0}),Y=s.useRef(null),M=s.useRef(null),v=s.useRef(null);s.useEffect(()=>{if(t&&U){const n=new Image;n.onload=()=>{v.current=n,z()},n.src=U}},[t,U,g,_]);const z=()=>{const n=Y.current,h=v.current;if(!n||!h)return;const o=n.getContext("2d"),y=M.current;if(!y)return;const c=y.offsetWidth,l=y.offsetHeight;n.width=c,n.height=l,o.fillStyle="rgba(0, 0, 0, 0.5)",o.fillRect(0,0,c,l);const N=Math.min(c/h.width,l/h.height)*_,i=h.width*N,w=h.height*N,x=(c-i)/2+g.x,k=(l-w)/2+g.y;o.save(),o.globalCompositeOperation="destination-out";const u=Math.min(c,l)*.7,b=(c-u)/2,C=(l-u)/2;f===1?(o.beginPath(),o.arc(c/2,l/2,u/2,0,Math.PI*2),o.fill()):o.fillRect(b,C,u,u/f),o.restore(),o.globalCompositeOperation="destination-over",o.drawImage(h,x,k,i,w),o.globalCompositeOperation="source-over",o.strokeStyle="#fff",o.lineWidth=2,f===1?(o.beginPath(),o.arc(c/2,l/2,u/2,0,Math.PI*2),o.stroke()):o.strokeRect(b,C,u,u/f)},L=n=>{X(!0),V({x:n.clientX-g.x,y:n.clientY-g.y})},G=n=>{q&&F({x:n.clientX-P.x,y:n.clientY-P.y})},A=()=>{X(!1)},Z=s.useCallback(async()=>{const n=v.current,h=M.current;if(!n||!h)return;const o=h.offsetWidth,y=h.offsetHeight,c=Math.min(o/n.width,y/n.height)*_,l=n.width*c,N=n.height*c,i=(o-l)/2+g.x,w=(y-N)/2+g.y,x=Math.min(o,y)*.7,k=(o-x)/2,u=(y-x)/2,b=document.createElement("canvas");b.width=x,b.height=x/f;const C=b.getContext("2d"),O=(k-i)/c,$=(u-w)/c,I=x/c,R=x/f/c;C.drawImage(n,O,$,I,R,0,0,x,x/f),b.toBlob(E=>{D(E),p()},"image/jpeg",.95)},[g,_,f,D,p]);return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:"Crop Image"}),e.jsx("div",{ref:M,className:"relative h-96 bg-gray-100 dark:bg-gray-700 rounded-lg mb-4 overflow-hidden cursor-move",onMouseDown:L,onMouseMove:G,onMouseUp:A,onMouseLeave:A,children:e.jsx("canvas",{ref:Y,className:"w-full h-full"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zoom"}),e.jsx("input",{type:"range",min:1,max:3,step:.1,value:_,onChange:n=>H(parseFloat(n.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[e.jsx(Pe,{size:16})," Cancel"]}),e.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-[#6C5DD3] text-white rounded-lg",children:[e.jsx(Ee,{size:16}),"  Save"]})]})]})})}):null},De=be("pk_test_51R6uLuGhmABE4SukbmgqsLITna4D57Ittag620AxGwm1ckI0oeYBXvNUBO9w4WhygDlp3sWd7ldWiZlGbR8jzxXk00N3jUSXPv"),Oe=()=>{ye(),je();const{user:t,role:p}=te(a=>a.user),{darkMode:U}=te(a=>a.theme),D="https://phplaravel-1547671-6035260.cloudwaysapps.com/storage";_e();const{showSnackbar:f}=we(),g=Fe(),[F,_]=s.useState(!1),[H,q]=s.useState(!1),[X,P]=s.useState(!1),[V,Y]=s.useState(!1),[M,v]=s.useState(null),[z,L]=s.useState(null),[G,A]=s.useState({current:!1,new:!1,confirm:!1}),[Z,n]=s.useState(!1),[h,o]=s.useState(!1),[y,c]=s.useState([]),[l,N]=s.useState(!1),[i,w]=s.useState(!1),[x,k]=s.useState(!1),[u,b]=s.useState(null),[C,O]=s.useState(null),[$,I]=s.useState(null),[R,E]=s.useState(null),{register:j,handleSubmit:B,formState:{errors:S},reset:W,control:le,setValue:$e}=ae({defaultValues:{first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",role:p||"",company_name:(t==null?void 0:t.company_name)||"",registration_number:(t==null?void 0:t.registration_number)||"",company_website:(t==null?void 0:t.company_website)||"",company_email:(t==null?void 0:t.company_email)||"",company_phone:(t==null?void 0:t.company_phone)||"",sub_domain:(t==null?void 0:t.sub_domain)||""}}),T=ve({control:le,name:"sub_domain"}),{register:Re,handleSubmit:We,formState:{errors:Te},reset:Xe}=ae();s.useEffect(()=>{t&&(W({first_name:t.first_name||"",last_name:t.last_name||"",email:t.email||"",phone:t.phone||"",role:p||"",company_name:t.company_name||"",registration_number:t.registration_number||"",company_website:t.company_website||"",company_email:t.company_email||"",company_phone:t.company_phone||"",sub_domain:(t==null?void 0:t.sub_domain)||""}),t.profile_image&&v(t.profile_image),t.company_logo_url&&L(t.company_logo_url),t.stripe_customer_id&&re(t.stripe_customer_id))},[t,W,p]);const re=async a=>{try{P(!0);const r=await Ne(a);r&&r.data&&c(r.data)}catch(r){console.error("Error fetching cards:",r),f("Failed to load payment methods","error")}finally{P(!1)}},ie=a=>{const r=a.target.files[0];if(r){const m=new FileReader;m.onload=()=>{b(m.result),O("profile"),k(!0)},m.readAsDataURL(r)}a.target.value=""},ce=a=>{const r=a.target.files[0];if(r){const m=new FileReader;m.onload=()=>{b(m.result),O("company"),k(!0)},m.readAsDataURL(r)}a.target.value=""},me=a=>{const r=new File([a],"cropped-image.jpg",{type:"image/jpeg"}),m=URL.createObjectURL(a);C==="profile"?(I(r),v(m)):C==="company"&&(E(r),L(m))},K=async(a,r=!1,m=!1)=>{var J,Q;if(!(!r&&!m))try{_(!0);const d=new FormData;d.append("_method","PATCH"),r&&(d.append("first_name",a.first_name),d.append("last_name",a.last_name),d.append("phone",a.phone),$&&d.append("profile_image",$)),m&&(a.company_name&&d.append("company_name",a.company_name),a.company_website&&d.append("company_website",a.company_website),a.company_email&&d.append("company_email",a.company_email),a.company_phone&&d.append("company_phone",a.company_phone),a.sub_domain&&d.append("sub_domain",a.sub_domain),R&&d.append("company_logo",R)),(await Se(d)).data&&(f(r&&m?"Profile & Company updated successfully":r?"Profile updated successfully":"Company updated successfully","success"),await g(),I(null),E(null),r&&N(!1),m&&w(!1))}catch(d){console.error("Update error:",d);const ee=((Q=(J=d.response)==null?void 0:J.data)==null?void 0:Q.message)||"Failed to update";f(ee,"error")}finally{_(!1)}},de=a=>K(a,!0,!1),pe=a=>K(a,!1,!0),fe=()=>{l&&(W({first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",phone:(t==null?void 0:t.phone)||""}),I(null),v((t==null?void 0:t.profile_image)||null)),N(a=>!a)},xe=()=>{i&&(W({company_name:(t==null?void 0:t.company_name)||"",company_website:(t==null?void 0:t.company_website)||"",company_email:(t==null?void 0:t.company_email)||"",company_phone:(t==null?void 0:t.company_phone)||"",sub_domain:(t==null?void 0:t.sub_domain)||""}),E(null),L((t==null?void 0:t.company_logo_url)||null)),w(a=>!a)},ue=a=>a?a.startsWith("blob:")||a.startsWith("http")?a:`${D}/${a}`:null,he=a=>a?a.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "):"Not Assigned";return s.useEffect(()=>{const a=(t==null?void 0:t.company_name)&&t.company_name.trim()!==""||(t==null?void 0:t.company_website)&&t.company_website.trim()!==""||(t==null?void 0:t.company_phone)&&t.company_phone.trim()!==""||(t==null?void 0:t.sub_domain)&&t.sub_domain.trim()!=="";p!=="investor"&&!a&&!i&&w(!0)},[t,p,i]),e.jsx("div",{className:"min-h-screen my-5",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b dark:border-b-[#333333]",children:[e.jsx("h1",{className:"text-3xl text-black dark:text-white",children:"My Profile"}),e.jsx("button",{type:"button",onClick:fe,className:"flex items-center gap-2 border rounded-lg px-2 py-2 text-black cursor-pointer dark:text-[#F8F8F8] dark:border-[#333333] dark:bg-[#121212]",children:l?e.jsxs(e.Fragment,{children:[e.jsx(se,{})," Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{})," Edit Profile"]})})]}),e.jsx("div",{className:"flex justify-start mt-8 ml-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:M?e.jsx("img",{src:ue(M),alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(ke,{className:"w-full h-full text-[#6C5DD3]"})}),l&&e.jsxs("label",{htmlFor:"profileImage",className:"border rounded-lg px-4 py-2 text-black dark:text-white cursor-pointer",children:["Upload Image",e.jsx("input",{type:"file",id:"profileImage",className:"hidden",accept:"image/*",onChange:ie})]})]})}),e.jsx("form",{onSubmit:B(de),children:e.jsx("div",{className:"profile-detail-form-container-main-div",children:e.jsxs("div",{className:"dark:bg-[#181818] bg-[#fff] profile-detail-form-container-wrap",children:[e.jsxs("div",{className:"w-[100%] md:w-[60%]",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"First Name"}),e.jsx("input",{type:"text",...j("first_name",{required:"First name is required"}),readOnly:!l,className:`form-control w-full ${S.first_name?"border border-red-500":""} ${l?"":"opacity-75 cursor-not-allowed"}`}),S.first_name&&l&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:S.first_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Last Name"}),e.jsx("input",{type:"text",...j("last_name",{required:"Last name is required"}),readOnly:!l,className:`form-control w-full ${S.last_name?"border border-red-500":""} ${l?"":"opacity-75 cursor-not-allowed"}`}),S.last_name&&l&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:S.last_name.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Email"}),e.jsx("input",{type:"email",...j("email"),disabled:!0,className:"form-control w-full opacity-75 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Phone Number"}),e.jsx("input",{type:"tel",...j("phone",{pattern:{value:/^(\+44|0044|0)\s?7\d{3}\s?\d{6}$|^(\+44|0044|0)\s?(1\d{1}|2\d{1}|3\d{1}|8\d{1})\d{2}\s?\d{6}$/,message:"Enter a valid UK phone number"}}),readOnly:!l,className:`form-control w-full ${S.phone?"border border-red-500":""} ${l?"":"opacity-75 cursor-not-allowed"}`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 mt-5 inline-block",children:"Role:"}),e.jsxs("div",{className:"relative opacity-75 cursor-not-allowed",children:[e.jsx("input",{type:"text",className:"form-control w-full cursor-not-allowed",value:he(p),readOnly:!0,style:{paddingLeft:"40px"}}),e.jsx("span",{className:"inline-block absolute left-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-purple",children:e.jsx(Ce,{})})]})]})]}),l&&e.jsx("div",{className:"text-right mb-8 mt-5",children:e.jsx("button",{type:"submit",className:"purple-btn flex items-center gap-2 ml-auto",disabled:F,children:F?e.jsx(oe,{size:20}):e.jsx(e.Fragment,{children:" Save Profile Changes"})})})]})})}),p!=="investor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b dark:border-b-[#333333] mt-10",children:[e.jsx("h1",{className:"text-xl text-black dark:text-[#F8F8F8]",children:"Company Details"}),p!=="team"&&p!=="team-lead"&&e.jsx("button",{type:"button",onClick:xe,className:"flex items-center gap-2 border rounded-lg px-2 py-2 text-black cursor-pointer dark:text-[#F8F8F8] dark:border-[#333333] dark:bg-[#121212]",children:i?e.jsxs(e.Fragment,{children:[e.jsx(se,{})," Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{})," Edit Company"]})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 p-5",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:e.jsx("img",{src:z||Le,alt:"Company Logo",className:"w-full h-full object-cover"})}),i&&e.jsxs("label",{className:"border rounded-lg px-4 py-2 text-black dark:text-white cursor-pointer",children:["Upload Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:ce})]})]}),e.jsxs("form",{onSubmit:B(pe),children:[e.jsx("div",{className:"dark:bg-[#181818] bg-[#fff] profile-detail-form-container-wrap",children:e.jsxs("div",{className:"w-[100%] md:w-[60%]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Name"}),e.jsx("input",{type:"text",...j("company_name"),readOnly:!i,className:`form-control w-full ${i?"":"opacity-75 cursor-not-allowed"}`})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] my-2 inline-block",children:"Sub Domain"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"your-company",...j("sub_domain"),readOnly:!i,className:`form-control w-full pr-48 ${i?"":"opacity-75 cursor-not-allowed"}`}),e.jsx("span",{className:"absolute inset-y-0 right-3 flex items-center text-gray-500 text-sm font-medium pointer-events-none",children:".visionvivante.in"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Your app will be available at:"," ",e.jsxs("strong",{className:"text-[#6C5DD3]",children:["https://",T!=null&&T.trim()?T.toLowerCase().trim().replace(/\s+/g,""):"your-company",".visionvivante.in"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Email"}),e.jsx("input",{type:"email",...j("company_email"),readOnly:!i,className:`form-control w-full ${i?"":"opacity-75 cursor-not-allowed"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Phone"}),e.jsx("input",{type:"tel",...j("company_phone",{pattern:{value:/^(\+44|0044|0)\s?7\d{3}\s?\d{6}$|^(\+44|0044|0)\s?(1\d{1}|2\d{1}|3\d{1}|8\d{1})\d{2}\s?\d{6}$/,message:"Enter a valid UK phone number"}}),readOnly:!i,className:`form-control w-full ${i?"":"opacity-75 cursor-not-allowed"}`})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Website"}),e.jsx("input",{type:"text",...j("company_website"),readOnly:!i,className:`form-control w-full ${i?"":"opacity-75 cursor-not-allowed"}`})]})]})}),i&&e.jsx("div",{className:"text-right mb-8",children:e.jsx("button",{type:"submit",className:"purple-btn flex items-center gap-2 ml-auto",disabled:F,children:F?e.jsx(oe,{size:20}):e.jsx(e.Fragment,{children:" Save Company Changes"})})})]})]}),e.jsx(Ue,{isOpen:x,onClose:()=>k(!1),imageSrc:u,onCropComplete:me,aspectRatio:1})]})})},He=()=>e.jsx(ge,{stripe:De,children:e.jsx(Oe,{})});export{He as default};
