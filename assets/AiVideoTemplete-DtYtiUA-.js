import{s as R,t as G,u as d,r as u,m as s,cE as H,aN as J,cF as K,cG as M,cH as U,cI as P,cJ as F,cK as q,cL as O}from"./index-Bbk-TWcL.js";const W=()=>{var k,_;console.log("AiVideoTemplete component rendered");const h=R(),j=G(),i=d(e=>e.deal.AiVideoData);d(e=>e.deal.SaveAiData);const m=d(e=>e.deal.VideoScenes),y=d(e=>e.deal.VideoVariables),x=d(e=>{var o;return(o=e.deal)==null?void 0:o.deal}),{user:w}=d(e=>e),[p,b]=u.useState(null),v=u.useRef(null),[a,T]=u.useState([]),[t,n]=u.useState(null),[N,f]=u.useState(!1),E=()=>{v.current.scrollBy({left:-200,behavior:"smooth"})},z=()=>{v.current.scrollBy({left:200,behavior:"smooth"})},B=async e=>{try{console.log("Fetching template data for ID:",e),console.log("getAiVideoVariables",y),console.log("getAiVideoScenes",m),y&&m&&m.length>0&&(console.log("getAiVideoScenes",m),j("/ai-video",{state:{templateId:e}}),f(!1))}catch(o){console.error("API error:",o)}},I=async e=>{var o,r,S,$,C,V,A,L;try{h(P([])),h(F([])),f(!0);const l=await q({template_id:e,user_id:(o=w.user)==null?void 0:o.id,deal_id:x.id});console.log("resssss",l),T(l.data.data.template),(r=l.data.data.template)!=null&&r.video_path&&n({type:"video",src:`https://superadmin.investire.uk/storage/${(S=l.data.data.template)==null?void 0:S.video_path}`}),((C=($=l.data.data.template)==null?void 0:$.image_paths)==null?void 0:C.length)>0&&n({type:"image",src:`https://superadmin.investire.uk/storage/${(V=l.data.data.template)==null?void 0:V.image_paths[0]}`});const g=await O({template_id:e,user_id:(A=w.user)==null?void 0:A.id,deal_id:x.id});console.log("resssss",g);const c=(L=g==null?void 0:g.data)==null?void 0:L.data;c&&(h(P((c==null?void 0:c.template.scenes)||[])),h(F((c==null?void 0:c.variables)||[])),f(!1))}catch(l){console.error("Error updating preference",l)}};return s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>j(`/deals/deal-view/${x.id}`),className:"flex items-center gap-2 mb-5",children:[s.jsx(H,{})," Back"]}),s.jsx("h4",{className:"font-bold text-3xl",children:"Select a template"}),s.jsx("p",{className:"mb-2 text-[#333333] dark:text-[#F8F8F8]",children:"Select a template to instantly generate your video content."}),i&&(i==null?void 0:i.length)>0?s.jsx("div",{className:"ai-video-grid m-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:i==null?void 0:i.map((e,o)=>s.jsxs("div",{className:"ai-video-card relative group cursor-pointer rounded-lg overflow-hidden shadow-md",children:[s.jsx("img",{src:(e==null?void 0:e.thumbnail_image_url)||J,alt:e==null?void 0:e.name,className:"w-full h-40 object-cover"}),s.jsx("h6",{className:"p-3 text-center font-medium",children:e==null?void 0:e.name}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("button",{className:`flex gap-1 items-center rounded-xl bg-white dark:bg-[#121212] text-[#6C5DD3] font-medium px-4 py-2 
                       opacity-0 translate-y-10 group-hover:opacity-100 group-hover:translate-y-0 
                       transition-all duration-300 ease-out`,onClick:r=>{r.stopPropagation(),b(e),I(e==null?void 0:e.template_id),console.log("Preview:",e==null?void 0:e.template_id)},children:[s.jsx(K,{})," Preview"]})})]},o))}):s.jsx("p",{children:"No AI video templates available."}),p&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 px-5",children:s.jsxs("div",{className:"bg-white dark:bg-[#121212] rounded-lg shadow-lg w-full max-w-4xl relative p-4 sm:p-6",children:[s.jsx("button",{className:"absolute top-3 right-3 text-gray-600 hover:text-black",onClick:()=>{b(null),n(null)},children:"âœ•"}),s.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 sm:px-10",children:s.jsx("div",{className:"w-full sm:w-[640px] h-[200px] sm:h-[360px] mx-auto flex items-center justify-center rounded-md overflow-hidden",children:t?t.type==="video"?s.jsx("video",{src:t.src,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"},t.src):s.jsx("img",{src:t.src,alt:"Selected preview",className:"w-full h-full object-contain"}):a!=null&&a.video_path?s.jsx("video",{src:`https://superadmin.investire.uk/storage/${a.video_path}`,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"},a.video_path):s.jsx("img",{src:(k=a==null?void 0:a.image_paths)!=null&&k[0]?`https://superadmin.investire.uk/storage/${a.image_paths[0]}`:null,alt:a==null?void 0:a.name,className:"w-full h-full object-contain"})})}),s.jsxs("div",{className:"relative mt-4 max-w-3xl mx-auto px-4 sm:px-10",children:[s.jsx("button",{onClick:E,className:"absolute left-0 top-1/2 -translate-y-1/2 shadow rounded-full p-2 bg-white z-10 hidden sm:block dark:bg-[#121212]",children:s.jsx(M,{className:"w-5 h-5"})}),s.jsxs("div",{ref:v,className:"flex gap-2 overflow-x-auto scrollbar-hide px-2 sm:px-8",children:[(a==null?void 0:a.video_path)&&(()=>{const e=`https://superadmin.investire.uk/storage/${a.video_path}`;return s.jsx("video",{src:e,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:`h-16 w-28 sm:h-20 sm:w-32 object-cover rounded cursor-pointer border-2 ${(t==null?void 0:t.type)==="video"&&(t==null?void 0:t.src)===e?"border-blue-500":"border-transparent"}`,onClick:()=>n({type:"video",src:e})})})(),(_=a==null?void 0:a.image_paths)==null?void 0:_.map((e,o)=>{const r=`https://superadmin.investire.uk/storage/${e}`;return s.jsx("img",{src:r,alt:`image-${o}`,className:`h-16 w-28 sm:h-20 sm:w-32 object-cover rounded cursor-pointer border-2 ${(t==null?void 0:t.type)==="image"&&(t==null?void 0:t.src)===r?"border-blue-500":"border-transparent"}`,onClick:()=>n({type:"image",src:r})},o)})]}),s.jsx("button",{onClick:z,className:"absolute right-0 top-1/2 -translate-y-1/2 shadow rounded-full p-2 bg-white z-10 hidden sm:block dark:bg-[#121212]",children:s.jsx(U,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex flex-row justify-end sm:gap-3 mt-6 gap-2",children:[s.jsx("button",{className:"border px-4 py-2 rounded-md w-full sm:w-auto",onClick:()=>{b(null),n(null)},children:"Cancel"}),s.jsx("button",{className:"purple-btn w-full sm:w-auto",onClick:()=>B(p==null?void 0:p.template_id),disabled:N,children:N?"Please wait...":"Use Template"})]})]})})]})};export{W as default};
