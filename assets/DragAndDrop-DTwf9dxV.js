import{r as a,m as e,at as D,au as T,ci as V}from"./index-eIodm8oU.js";import{u as Y}from"./index-CRe_XmSW.js";const H=({onImagesChange:d,maxFiles:p=10,initialImages:c=[],onClose:w,title:L="Upload Images",acceptedFileTypes:u="image/*,video/*"})=>{const[o,m]=a.useState([]),[i,x]=a.useState([]),[f,v]=a.useState([]),[N,j]=a.useState(0),[U,n]=a.useState(""),[h,k]=a.useState([]),[M,R]=a.useState(!1);a.useEffect(()=>{if(c&&c.length>0){const s=c.filter(r=>r!==null).map(r=>typeof r=="string"?r:URL.createObjectURL(r));x(s);const t=c.filter(r=>r!==null).map(r=>typeof r=="string"?"image":r.type.startsWith("video/")?"video":"image");v(t);const l=c.filter(r=>r!==null);m(l)}},[c]);const E=a.useCallback(s=>{if(o.length+s.length>p){n(`You can only upload up to ${p} images.`);return}const t=[...o,...s],l=[...i,...s.map(g=>URL.createObjectURL(g))],r=[...f,...s.map(g=>g.type.startsWith("video/")?"video":"image")];m(t),x(l),v(r),d(t),n(""),R(!0);const A=s.map(()=>0);k(A),s.forEach((g,S)=>{let y=0;const W=setInterval(()=>{y+=10,k(B=>{const z=[...B];return z[S]=y,z}),y>=100&&(clearInterval(W),S===s.length-1&&R(!1))},100)})},[o,p,d,i,f]),b={};u.includes("image/*")&&(b["image/*"]=[".jpeg",".jpg",".png",".gif",".webp"]),u.includes("video/*")&&(b["video/*"]=[".mp4",".webm",".ogg",".mov"]);const{getRootProps:O,getInputProps:$,isDragActive:P}=Y({onDrop:E,accept:b,maxSize:20971520,onDropRejected:s=>{var l,r;const t=(r=(l=s[0])==null?void 0:l.errors[0])==null?void 0:r.code;n(t==="file-too-large"?"File is too large. Max size is 20MB.":t==="file-invalid-type"?`Only ${u.replace("*","")} files are allowed.`:"Invalid file. Please try again.")}}),C=s=>{const t=[...o];t.splice(s,1),m(t);const l=[...i];typeof l[s]=="string"&&l[s].startsWith("blob:")&&URL.revokeObjectURL(l[s]),l.splice(s,1),x(l);const r=[...f];r.splice(s,1),v(r),N>=l.length&&l.length>0?j(l.length-1):l.length===0&&j(0),d(t)};return a.useEffect(()=>()=>{i.forEach(s=>{typeof s=="string"&&s.startsWith("blob:")&&URL.revokeObjectURL(s)})},[i]),e.jsx("div",{className:"comparables-upload-image-popup fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50",children:e.jsx("div",{className:"dark:bg-gray-800 bg-white rounded-lg p-6 w-full max-w-3xl",children:e.jsxs("div",{className:"overflow-y-auto max-h-[90vh] pe-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h6",{className:"text-[#000] dark:text-white",children:L}),e.jsx("button",{onClick:w,className:"dark:text-gray-400 text-[#ef4444]",children:e.jsx(D,{size:24})})]}),e.jsxs("div",{...O(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer mb-6 transition-colors
            ${P?"border-purple-500 bg-purple-900 bg-opacity-10":"border-gray-600 hover:border-purple-400"}`,children:[e.jsx("input",{...$()}),e.jsx(T,{className:"mx-auto text-purple-500",size:48}),P?e.jsx("p",{className:"mt-2 text-purple-400",children:"Drop the files here ..."}):e.jsx("p",{className:"mt-2 text-gray-400",children:"Drag and drop files here, or click to select files"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Supported formats: ",u.replace(/\*/g,"")," (Max: ",p," files, 20MB each)"]})]}),U&&e.jsx("div",{className:"text-red-500 mb-4 p-2 bg-red-900 bg-opacity-20 rounded",children:U}),i.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-6 gap-2",children:i.map((s,t)=>e.jsxs("div",{className:`relative h-20 rounded cursor-pointer overflow-hidden border-2 
                    ${t===N?"border-purple-500":"border-transparent"}`,onClick:()=>j(t),children:[f[t]==="video"?e.jsxs("div",{className:"w-full h-full bg-gray-700 flex items-center justify-center",children:[e.jsx(V,{className:"text-gray-400",size:24}),e.jsx("div",{className:"absolute inset-0 opacity-30",children:e.jsx("video",{src:s,className:"w-full h-full object-cover"})})]}):e.jsx("img",{src:s,alt:`Thumbnail ${t}`,className:"w-full h-full object-cover"}),e.jsx("button",{onClick:l=>{l.stopPropagation(),C(t)},className:"absolute top-1 right-1 text-white rounded-full p-1 flex items-center justify-center",style:{width:"20px",height:"20px"},children:e.jsx(D,{size:14,className:"text-[#ef4444]"})})]},t))}),M&&h.length>0&&e.jsx("div",{className:"space-y-2 mb-6",children:o.slice(-h.length).map((s,t)=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-white text-sm flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"truncate max-w-[200px]",children:s.name}),e.jsxs("span",{children:[Math.round(s.size/(1024*1024))," MB"]})]}),e.jsx("div",{className:"h-2 bg-gray-600 rounded overflow-hidden",children:e.jsx("div",{className:"bg-purple-500 h-full transition-all duration-300",style:{width:`${h[t]}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-400",children:[h[t],"%"]})]},t))})]}),e.jsx("div",{className:"flex justify-end mt-6 gap-4",children:e.jsx("button",{onClick:()=>{d(o),w()},className:"purple-btn items-center",children:o.length>0?"Save":"Cancel"})})]})})})};export{H as D};
