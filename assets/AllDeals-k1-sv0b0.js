import{t as Ee,r as i,u as Y,m as e,n as se,F as re,o as ne,p as ae,q as Ye,a3 as Ue,a4 as ze,a5 as Ve,a6 as Ge,s as Qe,a7 as We,a8 as ge,G as qe,y as Je,x as Ke,A as Xe,a9 as Ze,aa as be,H as je,I as ye,J as ve,K as we,M as _e,B as et,C as tt,D as De,ab as st,E as rt,N as nt,O as at}from"./index-iRB_0ci3.js";import{S as ke}from"./SendContactDealModal-Dva2yDbg.js";import{D as it}from"./DeleteConfirmationModal-BSQMlgow.js";import{A as ie,a as oe}from"./index-B7K7670-.js";import{A as le,m as ce}from"./proxy-oDoOEhG_.js";import{P as ot}from"./PaginationNew-5OmsUQmD.js";import{A as lt}from"./ArchiveConfirmationModal-DkceK6ZR.js";import{H as ct}from"./index-l2UplNj3.js";import{l as dt}from"./lodash-BLzwDM3w.js";const ut=({deals:a=[],selectedDeals:k,setSelectedDeals:D,handleSelectDeal:M,pagination:_,filters:z,handleSort:H,handleViewDeal:O,handleEditDeal:F,openDeleteConfirmation:P,formatAddress:E,getDealDescription:T,archive:u,openArchiveConfirmation:B})=>{const o=Ee(),[d,b]=i.useState(null),[g,h]=i.useState({top:0,left:0}),[U,L]=i.useState(!1),A=i.useRef(null),R=i.useRef({}),{user:N,role:I}=Y(s=>s.user),t=()=>{o("/")};i.useEffect(()=>{function s(y){A.current&&!A.current.contains(y.target)&&b(null)}function x(){d!==null&&b(null)}function c(){if(d!==null&&R.current[d]){const m=R.current[d].getBoundingClientRect(),S=window.innerHeight-m.bottom,v=m.top;L(S<200&&v>200),h({top:U?m.top-10:m.bottom+5,left:m.right-160})}}return c(),document.addEventListener("mousedown",s),document.addEventListener("scroll",x,!0),window.addEventListener("resize",c),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("scroll",x,!0),window.removeEventListener("resize",c)}},[d,U]);const l=s=>(s==null?void 0:s.deal_type_id)===2?"Service accommodation (SA)":(s==null?void 0:s.deal_type_id)===3?"Single Let":(s==null?void 0:s.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"dark:!bg-[#181818] dark:text-[#A1A1A1] text-black",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:s=>{if(s.target.checked){const x=a.filter(c=>c.step_completed===5).map(c=>c.id);D(x)}else D([])},checked:a.filter(s=>s.step_completed===5).length>0&&a.filter(s=>s.step_completed===5).every(s=>k.includes(s.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"ACTIONS"})]})}),e.jsx("tbody",{children:a.length>0?a.map((s,x)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:k.includes(s.id),onChange:()=>M(s.id),disabled:s.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{F(s.id,s==null?void 0:s.step_completed),t()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:E(s)})}),e.jsx("td",{children:(s==null?void 0:s.property_type_category_name)||""}),e.jsx("td",{children:(()=>{var v,G;const c=(v=s.property_deal_investment)==null?void 0:v.return_on_cash_investment_percentage,y=(G=s.property_deal_sa_investment)==null?void 0:G.net_roi_percentage,m=c??y;if(m==null)return"0%";const S=parseFloat(m);return S<0?"Infinite":`${Math.round(S)}%`})()}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:l(s)||(s==null?void 0:s.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${u==="archive"?"bg-red-100 text-red-700 border border-red-300":s.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:u==="archive"?s.status:s.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:s.created_at?new Date(s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{className:"flex justify-center relative",children:e.jsx("button",{ref:c=>R.current[s.id]=c,onClick:()=>b(d===s.id?null:s.id),className:"text-lg",children:e.jsx(se,{className:"text-[#595959]"})})})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(le,{children:d!==null&&e.jsxs(ce.div,{ref:A,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${g.top}px`,left:`${g.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[u!=="archive"&&e.jsxs("button",{onClick:()=>{const s=a.find(x=>x.id===d);O(s),b(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ie,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const s=a.find(x=>x.id===d);F(s==null?void 0:s.id,s==null?void 0:s.step_completed),b(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:u==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(ne,{className:"mr-2"})," Edit"]})}),u!=="archive"&&e.jsxs("button",{onClick:()=>{B(d),b(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(oe,{className:"mr-2"})," Archive Deal"]}),I!=="team"&&e.jsxs("button",{onClick:()=>{P(d),b(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Delete"]})]})})]})},pt=({deals:a=[],selectedDeals:k,setSelectedDeals:D,handleSelectDeal:M,pagination:_,filters:z,handleSort:H,handleViewDeal:O,handleEditDeal:F,openDeleteConfirmation:P,formatAddress:E,getDealDescription:T,archive:u,openArchiveConfirmation:B})=>{const[o,d]=i.useState(null),[b,g]=i.useState(!1),h=i.useRef(null),{user:U,role:L}=Y(t=>t.user);i.useEffect(()=>{function t(l){h.current&&!h.current.contains(l.target)&&d(null)}if(o!==null&&h.current){const l=h.current.getBoundingClientRect(),s=window.innerHeight-l.bottom;g(s<150)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[o]);const[A,R]=i.useState({top:0,left:0}),N=i.useRef({});i.useEffect(()=>{function t(x){h.current&&!h.current.contains(x.target)&&d(null)}function l(){o!==null&&d(null)}function s(){if(o!==null&&N.current[o]){const c=N.current[o].getBoundingClientRect(),y=window.innerHeight-c.bottom,m=c.top;g(y<200&&m>200),R({top:b?c.top-10:c.bottom+5,left:c.right-160})}}return s(),document.addEventListener("mousedown",t),document.addEventListener("scroll",l,!0),window.addEventListener("resize",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("scroll",l,!0),window.removeEventListener("resize",s)}},[o,b]);const I=t=>(t==null?void 0:t.deal_type_id)===2?"Service accommodation (SA)":(t==null?void 0:t.deal_type_id)===3?"Single Let":(t==null?void 0:t.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:`${a.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const l=a.filter(s=>s.step_completed===5).map(s=>s.id);D(l)}else D([])},checked:a.filter(t=>t.step_completed===5).length>0&&a.filter(t=>t.step_completed===5).every(t=>k.includes(t.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"ACTIONS"})]})}),e.jsx("tbody",{children:a.length>0?a.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:k.includes(t.id),onChange:()=>M(t.id),disabled:t.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{F(t.id,t==null?void 0:t.step_completed),handleAddressView()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:E(t)})}),e.jsx("td",{children:(t==null?void 0:t.property_type_category_name)||""}),e.jsx("td",{children:(()=>{var m,S;const s=(m=t.property_deal_investment)==null?void 0:m.return_on_cash_investment_percentage,x=(S=t.property_deal_sa_investment)==null?void 0:S.net_roi_percentage,c=s??x;if(c==null)return"0%";const y=parseFloat(c);return y<0?"Infinite":`${Math.round(y)}%`})()}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:I(t)||(t==null?void 0:t.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${u==="archive"?"bg-red-100 text-red-700 border border-red-300":t.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:u==="archive"?t.status:t.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{id:`dropdown-${t.id}`,className:"flex justify-center relative",children:e.jsx("button",{ref:s=>N.current[t.id]=s,onClick:()=>d(o===t.id?null:t.id),className:"text-lg",children:e.jsx(se,{className:"text-[#595959]"})})})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(le,{children:o!==null&&e.jsxs(ce.div,{ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${A.top}px`,left:`${A.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[u!=="archive"&&e.jsxs("button",{onClick:()=>{const t=a.find(l=>l.id===o);O(t),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ie,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const t=a.find(l=>l.id===o);F(t==null?void 0:t.id,t==null?void 0:t.step_completed),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:u==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(ne,{className:"mr-2"})," Edit"]})}),u!=="archive"&&e.jsxs("button",{onClick:()=>{B(o),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(oe,{className:"mr-2"})," Archive Deal"]}),L!=="team"&&e.jsxs("button",{onClick:()=>{P(o),d(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Delete"]})]})})]})},ht=({deals:a=[],selectedDeals:k,setSelectedDeals:D,handleSelectDeal:M,pagination:_,filters:z,handleSort:H,handleViewDeal:O,handleEditDeal:F,openDeleteConfirmation:P,formatAddress:E,getDealDescription:T,archive:u,openArchiveConfirmation:B})=>{const[o,d]=i.useState(null),[b,g]=i.useState(!1),h=i.useRef(null),{user:U,role:L}=Y(t=>t.user);i.useEffect(()=>{function t(l){h.current&&!h.current.contains(l.target)&&d(null)}if(o!==null&&h.current){const l=h.current.getBoundingClientRect(),s=window.innerHeight-l.bottom;g(s<150)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[o]);const[A,R]=i.useState({top:0,left:0}),N=i.useRef({});i.useEffect(()=>{function t(x){h.current&&!h.current.contains(x.target)&&d(null)}function l(){o!==null&&d(null)}function s(){if(o!==null&&N.current[o]){const c=N.current[o].getBoundingClientRect(),y=window.innerHeight-c.bottom,m=c.top;g(y<200&&m>200),R({top:b?c.top-10:c.bottom+5,left:c.right-160})}}return s(),document.addEventListener("mousedown",t),document.addEventListener("scroll",l,!0),window.addEventListener("resize",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("scroll",l,!0),window.removeEventListener("resize",s)}},[o,b]);const I=t=>(t==null?void 0:t.deal_type_id)===2?"Service accommodation (SA)":(t==null?void 0:t.deal_type_id)===3?"Single Let":(t==null?void 0:t.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:`${a.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const l=a.filter(s=>s.step_completed===5).map(s=>s.id);D(l)}else D([])},checked:a.filter(t=>t.step_completed===5).length>0&&a.filter(t=>t.step_completed===5).every(t=>k.includes(t.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"ACTIONS"})]})}),e.jsx("tbody",{children:a.length>0?a.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:k.includes(t.id),onChange:()=>M(t.id),disabled:t.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{F(t.id,t==null?void 0:t.step_completed),handleAddressView()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:E(t)})}),e.jsx("td",{children:(t==null?void 0:t.property_type_category_name)||""}),e.jsx("td",{children:(()=>{var m,S;const s=(m=t.property_deal_investment)==null?void 0:m.return_on_cash_investment_percentage,x=(S=t.property_deal_sa_investment)==null?void 0:S.net_roi_percentage,c=s??x;if(c==null)return"0%";const y=parseFloat(c);return y<0?"Infinite":`${Math.round(y)}%`})()}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:I(t)||(t==null?void 0:t.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${u==="archive"?"bg-red-100 text-red-700 border border-red-300":t.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:u==="archive"?t.status:t.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{id:`dropdown-${t.id}`,className:"flex justify-center relative",children:e.jsx("button",{ref:s=>N.current[t.id]=s,onClick:()=>d(o===t.id?null:t.id),className:"text-lg",children:e.jsx(se,{className:"text-[#595959]"})})})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(le,{children:o!==null&&e.jsxs(ce.div,{ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${A.top}px`,left:`${A.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[u!=="archive"&&e.jsxs("button",{onClick:()=>{const t=a.find(l=>l.id===o);O(t),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ie,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const t=a.find(l=>l.id===o);F(t==null?void 0:t.id,t==null?void 0:t.step_completed),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:u==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(ne,{className:"mr-2"})," Edit"]})}),u!=="archive"&&e.jsxs("button",{onClick:()=>{B(o),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(oe,{className:"mr-2"})," Archive Deal"]}),L!=="team"&&e.jsxs("button",{onClick:()=>{P(o),d(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Delete"]})]})})]})},xt=({deals:a=[],selectedDeals:k,setSelectedDeals:D,handleSelectDeal:M,pagination:_,filters:z,handleSort:H,handleViewDeal:O,handleEditDeal:F,openDeleteConfirmation:P,formatAddress:E,getDealDescription:T,archive:u,openArchiveConfirmation:B})=>{const[o,d]=i.useState(null),[b,g]=i.useState(!1),h=i.useRef(null),{user:U,role:L}=Y(t=>t.user);i.useEffect(()=>{function t(l){h.current&&!h.current.contains(l.target)&&d(null)}if(o!==null&&h.current){const l=h.current.getBoundingClientRect(),s=window.innerHeight-l.bottom;g(s<150)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[o]);const[A,R]=i.useState({top:0,left:0}),N=i.useRef({});i.useEffect(()=>{function t(x){h.current&&!h.current.contains(x.target)&&d(null)}function l(){o!==null&&d(null)}function s(){if(o!==null&&N.current[o]){const c=N.current[o].getBoundingClientRect(),y=window.innerHeight-c.bottom,m=c.top;g(y<200&&m>200),R({top:b?c.top-10:c.bottom+5,left:c.right-160})}}return s(),document.addEventListener("mousedown",t),document.addEventListener("scroll",l,!0),window.addEventListener("resize",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("scroll",l,!0),window.removeEventListener("resize",s)}},[o,b]);const I=t=>(t==null?void 0:t.deal_type_id)===2?"Service accommodation (SA)":(t==null?void 0:t.deal_type_id)===3?"Single Let":(t==null?void 0:t.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:`${a.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const l=a.filter(s=>s.step_completed===5).map(s=>s.id);D(l)}else D([])},checked:a.filter(t=>t.step_completed===5).length>0&&a.filter(t=>t.step_completed===5).every(t=>k.includes(t.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"ACTIONS"})]})}),e.jsx("tbody",{children:a.length>0?a.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:k.includes(t.id),onChange:()=>M(t.id),disabled:t.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{F(t.id,t==null?void 0:t.step_completed),handleAddressView()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:E(t)})}),e.jsx("td",{children:(t==null?void 0:t.property_type_category_name)||""}),e.jsx("td",{children:(()=>{var m,S;const s=(m=t.property_deal_investment)==null?void 0:m.return_on_cash_investment_percentage,x=(S=t.property_deal_sa_investment)==null?void 0:S.net_roi_percentage,c=s??x;if(c==null)return"0%";const y=parseFloat(c);return y<0?"Infinite":`${Math.round(y)}%`})()}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:I(t)||(t==null?void 0:t.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${u==="archive"?"bg-red-100 text-red-700 border border-red-300":t.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:u==="archive"?t.status:t.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{id:`dropdown-${t.id}`,className:"flex justify-center relative",children:e.jsx("button",{ref:s=>N.current[t.id]=s,onClick:()=>d(o===t.id?null:t.id),className:"text-lg",children:e.jsx(se,{className:"text-[#595959]"})})})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(le,{children:o!==null&&e.jsxs(ce.div,{ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${A.top}px`,left:`${A.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[u!=="archive"&&e.jsxs("button",{onClick:()=>{const t=a.find(l=>l.id===o);O(t),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ie,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const t=a.find(l=>l.id===o);F(t==null?void 0:t.id,t==null?void 0:t.step_completed),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:u==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(ne,{className:"mr-2"})," Edit"]})}),u!=="archive"&&e.jsxs("button",{onClick:()=>{B(o),d(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(oe,{className:"mr-2"})," Archive Deal"]}),L!=="team"&&e.jsxs("button",{onClick:()=>{P(o),d(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Delete"]})]})})]})},mt=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"",Nt=()=>{const[a,k]=i.useState("all"),{user:D,role:M}=Y(r=>r.user),[_,z]=i.useState("all"),H=Ee(),[O,F]=i.useState([]);Y(r=>r.deal.currentStep),Y(r=>r.deal.dealFilters);const P=Y(r=>r.deal.dealsTypes),[E,T]=i.useState([]),{showSnackbar:u}=Ye(),[B,o]=i.useState(!1),[d,b]=i.useState(!1),[g,h]=i.useState(0),[U,L]=i.useState(!1),[A,R]=i.useState(!1),[N,I]=i.useState(null),[t,l]=i.useState(null),[s,x]=i.useState(!1),[c,y]=i.useState(!1),[m,S]=i.useState(""),[v,G]=i.useState({currentPage:1,totalPages:1,from:0,to:0,total:0,hasMorePages:!1}),Ne=[{label:"Total deals",status:"all",icon:e.jsx(Ue,{className:"text-lg text-[#595959] dark:text-[#C5C5C5]"}),count:g==null?void 0:g.all},{label:"Draft deals",status:"draft",icon:e.jsx(ct,{className:"text-2xl text-[#595959] dark:text-[#C5C5C5]"}),count:g==null?void 0:g.draft},{label:"Published deals",status:"publish",icon:e.jsx(ze,{className:"text-2xl text-[#595959] dark:text-[#C5C5C5]"}),count:g==null?void 0:g.publish},{label:"Archived deals",status:"archive",icon:e.jsx(Ve,{className:"text-2xl text-[#595959] dark:text-[#C5C5C5]"}),count:g==null?void 0:g.archive}];i.useEffect(()=>{V(r=>({...r,status:_==="all"?"all":_,page:1}))},[_]),i.useEffect(()=>{var n,f;const r=a==="all"?1:((f=(n=P==null?void 0:P.deal_types)==null?void 0:n.find(w=>w.slug===a))==null?void 0:f.id)??null;V(w=>({...w,dealTypeId:r,page:1}))},[a]);const[j,V]=i.useState({per_page:(v==null?void 0:v.total)>=10||(v==null?void 0:v.total)==0?10:(v==null?void 0:v.total)||1,page:1,status:"",year:"",propertyTypeId:"",dealTypeId:"",search:"",sortColumn:"created_at",sortOrder:"desc"}),{data:de,loading:Se}=Ge(Ze),C=Qe(),Q=async()=>{var r,n;try{b(!0);const f={page:j.page,perPage:j.per_page,status:j.status===""?null:j.status,year:j.year===""?null:j.year,propertyTypeId:j.propertyTypeId===""?null:j.propertyTypeId,sortColumn:j.sortColumn,sortOrder:j.sortOrder,search:j.search===""?null:j.search};a!=="all"&&a!=="tab"&&(f.dealTypeId=j.dealTypeId);const w=await Xe(f);if(w&&w.data){h((n=(r=w==null?void 0:w.data)==null?void 0:r.data)==null?void 0:n.dealsCount),F(w.data.data.deals||[]);const p=w.data.data.page_context;p&&G({currentPage:parseInt(p==null?void 0:p.page)||1,totalPages:Math.ceil(parseInt((p==null?void 0:p.total_records)||0)/parseInt((p==null?void 0:p.per_page)||10)),from:(parseInt(p.page)-1)*parseInt(p.per_page)+1,to:Math.min(parseInt(p==null?void 0:p.page)*parseInt(p==null?void 0:p.per_page),parseInt((p==null?void 0:p.total_records)||0)),total:parseInt((p==null?void 0:p.total_records)||0),hasMorePages:(p==null?void 0:p.has_more_page)==="true"})}}catch{u("Failed to fetch deals. Please try again.","error")}finally{b(!1)}},Ce=dt.debounce(r=>{V(n=>({...n,search:r,page:1}))},1e3),Ae=r=>{const n=r.target.value;S(n),Ce(n)};i.useEffect(()=>{j.dealTypeId&&Q()},[j]);const W=r=>{T(n=>n.includes(r)?n.filter(f=>f!==r):[...n,r])},Fe=()=>{if(E.length===0){u("Please select at least one deal.","error");return}o(!0)},Re=()=>{o(!1)},q=r=>{V(n=>({...n,sortColumn:r,sortOrder:n.sortColumn===r&&n.sortOrder==="asc"?"desc":"asc",page:1}))},J=async r=>{const n={user_id:r==null?void 0:r.user_id,property_deal_id:r==null?void 0:r.id};r.deal_type_id==2?(await De(n),H(`/deals/deal-view/${r.id}`)):(await De(n),H(`/deals/deal-view/${r.id}`))},K=r=>{I(r),L(!0)},X=r=>{l(r),R(!0)},Z=async r=>{var n;try{b(!0);const f=await st(r);f?(u((n=f==null?void 0:f.data)==null?void 0:n.message),Q()):u("Failed to restore deal","error")}catch(f){console.error("Restore failed:",f),u("Something went wrong","error")}finally{b(!1)}},Oe=async()=>{var r;if(t)try{y(!0);let n=await tt(t);u((r=n==null?void 0:n.data)==null?void 0:r.message),Q(),R(!1),l(null)}catch(n){console.error("Error deleting deal:",n),u("Failed to delete deal",n)}finally{y(!1)}},Pe=async()=>{var r;if(N)try{x(!0);let n=await et(N);u((r=n==null?void 0:n.data)==null?void 0:r.message),Q(),L(!1),I(null)}catch(n){console.error("Error deleting deal:",n),u("Failed to delete deal","error")}finally{x(!1)}},Le=()=>{const r=D==null?void 0:D.user_subscription,n=!!r,f=(r==null?void 0:r.left_days)??0,w=(r==null?void 0:r.deal_limit)??0;if(!n||f===0){u("Your subscription has ended. Please upgrade.","warning");return}if(w===0){u("Your deal limit is used up. Please upgrade.","warning");return}C(be()),C(je()),C(ye()),C(ve()),C(we()),C(_e()),H("/create-deal")},ee=r=>{const n=[];r.address_line_1&&n.push(r.address_line_1),r.address_line_2&&n.push(r.address_line_2),r.city&&n.push(r.city),r.post_code&&n.push(r.post_code);const f=n.join(", "),w=120;return f.length>w?f.substring(0,w)+"...":f};de!=null&&de.data;const Te=new Date().getFullYear();Array.from({length:4},(r,n)=>Te-n);const te=async(r,n)=>{var f,w,p,pe,he,xe;if(r)try{b(!0);const $=await rt(r);C(je()),C(ye()),C(ve()),C(we()),C(_e());for(let ue=1;ue<=n;ue++)C({type:`deal/setDealSteps${ue}`,payload:!0});C(be());const me=((f=$==null?void 0:$.data)==null?void 0:f.data)||{},$e=me.propertyDealSaInvestment||me.propertyDealInvestment||{},{id:gt,...Me}=$e||{},fe=((pe=(p=(w=$==null?void 0:$.data)==null?void 0:w.data)==null?void 0:p.deal)==null?void 0:pe.step_completed)||1,He={...(xe=(he=$==null?void 0:$.data)==null?void 0:he.data)==null?void 0:xe.deal,...Me,step:fe};C(nt(He)),C(at(fe)),H("/create-deal/address?mode=edit")}catch{u("Failed to edit deal. Please try again.","error")}finally{b(!1)}},[Be,Ie]=i.useState(!1),{id:ft}=We();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-xl md:text-3xl font-semibold text-dark dark:text-white",children:["Welcome Back, ",mt(D==null?void 0:D.first_name)]}),e.jsxs("button",{onClick:Le,className:"purple-btn flex items-center gap-2",children:[e.jsx("span",{className:"md:hidden",children:e.jsx(ge,{className:"text-2xl text-white"})}),e.jsxs("span",{className:"hidden md:flex items-center gap-2",children:[e.jsx(ge,{className:"text-xl text-white"}),"Create a new deal"]})]})]}),e.jsxs("div",{className:"overflow-x-auto p-0",children:[e.jsx(it,{isOpen:U,onClose:()=>L(!1),onConfirm:Pe,title:"Delete Deal",isLoading:s}),e.jsx(lt,{isOpen:A,onClose:()=>R(!1),onConfirm:Oe,title:"Archive Deal",isLoading:c}),e.jsx(ke,{isOpen:Be,onClose:()=>{Ie(!1),T([])},selectedDeals:E}),e.jsx("div",{className:"deals-assets-grid-wrap my-10",children:Ne.map(({label:r,status:n,icon:f,count:w})=>e.jsxs("div",{className:`deals-assets-grid-col cursor-pointer ${_===n?"!border !border-[#AFB6F2] !bg-[#F6F7FE] !bg-none dark:!bg-none dark:!bg-[#262145] dark:!border-[#6C5DD3]":""}`,onClick:()=>z(n),children:[e.jsxs("div",{className:"flex justify-between deals-assets-heading mb-7",children:[e.jsx("p",{className:`${_===n?"!bg-[#F6F7FE] border-[#AFB6F2] text-black dark:!bg-[#262145] dark:!border-[#6C5DD3] dark:!text-white":"text-[#595959] dark:text-[#C5C5C5]"} font-medium`,children:r}),e.jsx("span",{className:`${_===n?"text-white":""}`,children:f})]}),e.jsx("h2",{className:`font-medium total-deals-assets ${_===n?"border-purple pb-1":"text-[#242424] dark:text-white"}`,children:w})]},n))}),e.jsx("h3",{className:"light-black font-medium mb-4 dark:text-white",children:"All deals"}),e.jsxs("div",{className:"flex flex-col-reverse md:flex-row justify-between items-start md:items-center mb-6 gap-4 md:gap-0",children:[e.jsx("div",{className:"",children:e.jsxs("ul",{className:"inline-flex flex-wrap deal-types-tabs-wrap gap-6",children:[e.jsx("li",{className:"",children:e.jsx("button",{onClick:()=>k("all"),className:`tab-btn ${a==="all"?"active":""}`,children:"All Deals Types"})}),e.jsx("li",{className:"",children:e.jsxs("button",{onClick:()=>k("sa"),className:`tab-btn ${a==="sa"?"active":""}`,children:[e.jsx("span",{className:"hidden md:inline",children:"Service accommodation (SA)"}),e.jsx("span",{className:"inline md:hidden",children:"SA"})]})}),e.jsx("li",{className:"",children:e.jsxs("button",{onClick:()=>k("hmo"),className:`tab-btn ${a==="hmo"?"active":""}`,children:[e.jsx("span",{className:"hidden md:inline",children:"House in multiple occupation(HMO)"}),e.jsx("span",{className:"inline md:hidden",children:"HMO"})]})}),e.jsx("li",{className:"",children:e.jsx("button",{onClick:()=>k("single_let"),className:`tab-btn ${a==="single_let"?"active":""}`,children:"Single let"})})]})}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 border border-[DADADA]  px-4 py-2 rounded-xl  ",onClick:r=>{r.preventDefault(),Fe()},children:[e.jsx(qe,{className:"text-2xl"}),e.jsx("span",{children:"Share"})]})]}),e.jsxs("div",{className:"total-deal-table-wrapper",children:[e.jsxs("div",{className:"relative custom-input-w my-3 ml-3",children:[e.jsx("input",{type:"text",placeholder:"Search for deals",className:"form-control",value:m,onChange:Ae,style:{paddingLeft:"40px"}}),e.jsx(Je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),d||Se?e.jsx(Ke,{}):e.jsxs("div",{className:"overflow-x-auto dark:bg-[#222632] bg-[#EBEBEC] comparable-listing-table-wrap",children:[a==="all"&&e.jsx(ut,{deals:O,selectedDeals:E,setSelectedDeals:T,handleSelectDeal:W,handleSort:q,filters:j,pagination:v,handleEditDeal:_==="archive"?Z:te,handleViewDeal:J,openDeleteConfirmation:K,openArchiveConfirmation:X,formatAddress:ee,archive:_}),a==="sa"&&e.jsx(pt,{deals:O,selectedDeals:E,setSelectedDeals:T,handleSelectDeal:W,handleSort:q,filters:j,pagination:v,handleEditDeal:_==="archive"?Z:te,handleViewDeal:J,openDeleteConfirmation:K,formatAddress:ee,archive:_,openArchiveConfirmation:X}),a==="hmo"&&e.jsx(xt,{deals:O,selectedDeals:E,setSelectedDeals:T,handleSelectDeal:W,handleSort:q,filters:j,pagination:v,handleEditDeal:_==="archive"?Z:te,handleViewDeal:J,openDeleteConfirmation:K,openArchiveConfirmation:X,formatAddress:ee,archive:_}),a==="single_let"&&e.jsx(ht,{deals:O,selectedDeals:E,setSelectedDeals:T,handleSelectDeal:W,handleSort:q,filters:j,pagination:v,handleEditDeal:_==="archive"?Z:te,handleViewDeal:J,openArchiveConfirmation:X,openDeleteConfirmation:K,formatAddress:ee,archive:_})]})]}),e.jsx(ot,{pagination:{total:v.total,currentPage:j.page,perPage:j.per_page>v.total?v.total:j.per_page,totalPages:Math.ceil(v.total/j.per_page)},setFilters:V}),B&&e.jsx(ke,{isOpen:B,onClose:Re,selectedDeals:E})]})]})};export{Nt as default};
