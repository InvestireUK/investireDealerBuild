import{v as G,w as I,u as d,r as u,m as e,cL as K,aM as Q,cM as U,cN as q,cO as H,cP as P,cQ as A,cR as J,be as R,cS as W}from"./index-BiLXWE_-.js";const Y=()=>{var k,S;const h=G(),j=I(),c=d(s=>s.deal.AiVideoData);d(s=>s.deal.SaveAiData);const y=d(s=>s.deal.VideoScenes),T=d(s=>s.deal.VideoVariables),[z,w]=u.useState(!1),g=d(s=>{var l;return(l=s.deal)==null?void 0:l.deal}),{user:N}=d(s=>s),[m,x]=u.useState(null),b=u.useRef(null),[a,F]=u.useState([]),[t,n]=u.useState(null),[_,p]=u.useState(!1),B=()=>{b.current.scrollBy({left:-200,behavior:"smooth"})},E=()=>{b.current.scrollBy({left:200,behavior:"smooth"})},M=async s=>{try{T&&y&&y.length>0&&(j("/ai-video",{state:{templateId:s}}),p(!1))}catch(l){console.error("API error:",l)}},O=async s=>{var l,i,C,$,L;try{h(P([])),h(A([])),p(!0);const r=(await J({template_id:s,user_id:(l=N.user)==null?void 0:l.id,deal_id:g.id})).data.data.template;F(r),r!=null&&r.video_path&&n({type:"video",src:`https://phplaravel-1547671-6035260.cloudwaysapps.com/storage/${r.video_path}`}),((i=r==null?void 0:r.image_paths)==null?void 0:i.length)>0&&n({type:"image",src:`https://phplaravel-1547671-6035260.cloudwaysapps.com/storage/${r.image_paths[0]}`});const v=await R({template_id:s,user_id:(C=N.user)==null?void 0:C.id,deal_id:g.id}),o=($=v==null?void 0:v.data)==null?void 0:$.data,f=o==null?void 0:o.user_subscriptions;if((f==null?void 0:f.ai_video_limit)===0){p(!1),x(null),n(null),w(!0);return}h(P(((L=o==null?void 0:o.template)==null?void 0:L.scenes)||[])),h(A((o==null?void 0:o.variables)||[])),h(W((o==null?void 0:o.validations)||[])),p(!1)}catch(V){console.error("Error updating preference",V),p(!1)}};return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>j(`/deals/deal-view/${g.id}`),className:"flex items-center gap-2 mb-5",children:[e.jsx(K,{})," Back"]}),e.jsx("h4",{className:"font-bold text-3xl",children:"Select a template"}),e.jsx("p",{className:"mb-2 text-[#333333] dark:text-[#F8F8F8]",children:"Select a template to instantly generate your video content."}),c&&(c==null?void 0:c.length)>0?e.jsx("div",{className:"ai-video-grid m-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:c==null?void 0:c.map((s,l)=>e.jsxs("div",{className:"ai-video-card relative group cursor-pointer rounded-lg overflow-hidden shadow-md",children:[e.jsx("img",{src:(s==null?void 0:s.thumbnail_image_url)||Q,alt:s==null?void 0:s.name,className:"w-full h-40 object-cover"}),e.jsx("h6",{className:"p-3 text-center font-medium",children:s==null?void 0:s.name}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("button",{className:`flex gap-1 items-center rounded-xl bg-white dark:bg-[#121212] text-[#6C5DD3] font-medium px-4 py-2 
                       opacity-0 translate-y-10 group-hover:opacity-100 group-hover:translate-y-0 
                       transition-all duration-300 ease-out`,onClick:i=>{i.stopPropagation(),x(s),O(s==null?void 0:s.template_id)},children:[e.jsx(U,{})," Preview"]})}),z&&e.jsx("div",{className:"fixed inset-0 flex justify-center items-center z-[9999]",children:e.jsxs("div",{className:"bg-white dark:bg-[#1e1e1e] p-6 rounded-xl w-[350px] text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-600",children:"AI Video Limit Reached"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Video Generation credit limit has been reached."}),e.jsx("button",{onClick:()=>w(!1),className:"mt-4 px-4 py-2 rounded-lg bg-[#6C5DD3] text-white hover:bg-[#5948b5]",children:"OK"})]})})]},l))}):e.jsx("p",{children:"No AI video templates available."}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 px-5",children:e.jsxs("div",{className:"bg-white dark:bg-[#121212] rounded-lg shadow-lg w-full max-w-4xl relative p-4 sm:p-6",children:[e.jsx("button",{className:"absolute top-3 right-3 text-gray-600 hover:text-black",onClick:()=>{x(null),n(null)},children:"âœ•"}),e.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 sm:px-10",children:e.jsx("div",{className:"w-full sm:w-[640px] h-[200px] sm:h-[360px] mx-auto flex items-center justify-center rounded-md overflow-hidden",children:t?t.type==="video"?e.jsx("video",{src:t.src,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"},t.src):e.jsx("img",{src:t.src,alt:"Selected preview",className:"w-full h-full object-contain"}):a!=null&&a.video_path?e.jsx("video",{src:`https://phplaravel-1547671-6035260.cloudwaysapps.com/storage/${a.video_path}`,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"},a.video_path):e.jsx("img",{src:(k=a==null?void 0:a.image_paths)!=null&&k[0]?`https://phplaravel-1547671-6035260.cloudwaysapps.com/storage/${a.image_paths[0]}`:null,alt:a==null?void 0:a.name,className:"w-full h-full object-contain"})})}),e.jsxs("div",{className:"relative mt-4 max-w-3xl mx-auto px-4 sm:px-10",children:[e.jsx("button",{onClick:B,className:"absolute left-0 top-1/2 -translate-y-1/2 shadow rounded-full p-2 bg-white z-10 hidden sm:block dark:bg-[#121212]",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsxs("div",{ref:b,className:"flex gap-2 overflow-x-auto scrollbar-hide px-2 sm:px-8",children:[(a==null?void 0:a.video_path)&&(()=>{const s=`https://phplaravel-1547671-6035260.cloudwaysapps.com/storage/${a.video_path}`;return e.jsx("video",{src:s,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:`h-16 w-28 sm:h-20 sm:w-32 object-cover rounded cursor-pointer border-2 ${(t==null?void 0:t.type)==="video"&&(t==null?void 0:t.src)===s?"border-blue-500":"border-transparent"}`,onClick:()=>n({type:"video",src:s})})})(),(S=a==null?void 0:a.image_paths)==null?void 0:S.map((s,l)=>{const i=`https://phplaravel-1547671-6035260.cloudwaysapps.com/storage/${s}`;return e.jsx("img",{src:i,alt:`image-${l}`,className:`h-16 w-28 sm:h-20 sm:w-32 object-cover rounded cursor-pointer border-2 ${(t==null?void 0:t.type)==="image"&&(t==null?void 0:t.src)===i?"border-blue-500":"border-transparent"}`,onClick:()=>n({type:"image",src:i})},l)})]}),e.jsx("button",{onClick:E,className:"absolute right-0 top-1/2 -translate-y-1/2 shadow rounded-full p-2 bg-white z-10 hidden sm:block dark:bg-[#121212]",children:e.jsx(H,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-row justify-end sm:gap-3 mt-6 gap-2",children:[e.jsx("button",{className:"border px-4 py-2 rounded-md w-full sm:w-auto",onClick:()=>{x(null),n(null)},children:"Cancel"}),e.jsx("button",{className:"purple-btn w-full sm:w-auto",onClick:()=>M(m==null?void 0:m.template_id),disabled:_,children:_?"Please wait...":"Use Template"})]})]})})]})};export{Y as default};
