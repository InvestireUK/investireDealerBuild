import{a3 as C,r as s,t as A,m as c,ae as L,af as R,a4 as T,w as W,v as $,ag as q,u as d,ac as j,S as k}from"./index-C3MMOsYh.js";const M=(n,r)=>{const t=C(),p=s.useRef(t.pathname.includes(n));s.useEffect(()=>{p.current=t.pathname.includes(n)},[n]),s.useEffect(()=>{const u=t.pathname.includes(n);p.current&&!u&&r(),p.current=u},[t.pathname,n,r])},O=({steps:n,currentStep:r,activeStep:t,navigationAllow:p,onStepClick:u,isComparablesRoute:x,deal:S})=>{const{showSnackbar:D}=A();C().pathname.endsWith("/summary");const[g,a]=s.useState(!1);return s.useEffect(()=>{const o=document.querySelector("nav.create-deals-tabs-wrap::after");if(o){const l=(t-1)/(n.length-1)*80+10;o.style.width=`${l}%`}},[t,n.length]),s.useEffect(()=>{const o=document.querySelector("nav.create-deals-tabs-wrap .nav-tab.active");o&&window.innerWidth<=1024&&o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[t,r]),c.jsxs("div",{className:"create-deal-page-wrap",children:[c.jsxs(L,{children:[c.jsx("div",{className:"Create-new-deal-heading-wrap flex justify-between items-center mb-3",children:c.jsx("h3",{className:"text-[#333333] font-medium dark:text-white",children:[5].includes(S==null?void 0:S.step_completed)?"Edit deal":"Create new deal"})}),c.jsx("nav",{className:"create-deals-tabs-wrap",children:n.map(({text:o,step:l,path:w,dealSteps:f})=>{const b=l===t||l===1&&x,h=p||l<=r;return c.jsxs("div",{className:`nav-tab ${b?"active":""} ${f?"step-checked":""}`,onClick:()=>h&&u(l,w),style:{pointerEvents:h?"auto":"none",opacity:b||h?1:.5,cursor:h?"pointer":"not-allowed"},children:[c.jsx("span",{className:"create-deals-step-num",children:f?c.jsx(R,{}):l}),c.jsx("span",{className:"create-deals-step-heading",children:o})]},l)})})]}),c.jsx("div",{className:"create-deal-address-form-outer-div-wrap",children:c.jsx(T,{})})]})},H=()=>{var N;const n=W(),r=C(),t=$(),[p]=q();p.get("mode");const[u,x]=s.useState([]),[S,D]=s.useState([]),m=d(e=>e.deal.currentStep),g=d(e=>e.deal.navigationAllow),a=d(e=>e.deal.deal);d(e=>e.deal.comparableMode);const o=d(e=>e.deal.dealSteps1),l=d(e=>e.deal.dealSteps2),w=d(e=>e.deal.dealSteps3),f=d(e=>e.deal.dealSteps4),b=d(e=>e.deal.dealSteps5),v=((...e)=>e.find(i=>Array.isArray(i)&&i.length>0)||[])(a==null?void 0:a.newcomperable,a==null?void 0:a.property_deal_comparables,a==null?void 0:a.property_deal_sa_comparables),y=[{text:"Address details",step:"01",path:"/create-deal/address",dealSteps:o},{text:"Financial details",step:"02",path:"/create-deal/financials",dealSteps:l},{text:"Description details",step:"03",path:"/create-deal/description",dealSteps:w},{text:"Comparable",step:"04",path:(v==null?void 0:v.length)>0?(a==null?void 0:a.deal_type_id)===2?"/create-deal/sa-comparable-table":"/create-deal/comparable-table":"/create-deal/comparables",dealSteps:f},{text:"Summary",step:"05",path:"/create-deal/summary",dealSteps:b}],E=r.pathname.includes("/create-deal/comparables")||r.pathname.includes("/create-deal/all-comparable"),I=E?4:(N=y.find(e=>r.pathname.includes(e.path)))==null?void 0:N.step,F=s.useCallback(()=>{t(j()),sessionStorage.removeItem("inCreateDealFlow"),sessionStorage.removeItem("currentStep")},[t]);M("/create-deal",F),s.useEffect(()=>{window.scrollTo(0,0)},[r.pathname]),s.useEffect(()=>{const e=sessionStorage.getItem("currentStep");if(e){const i=Number(e);isNaN(i)||t(k(i))}},[]),s.useEffect(()=>{sessionStorage.setItem("currentStep",m.toString())},[m]),s.useEffect(()=>{const e=sessionStorage.getItem("inCreateDealFlow"),i=r.pathname.startsWith("/create-deal");!a&&(!e||!i)&&(t(j()),n("/create-deal/address",{replace:!0}))},[a,n,t,r.pathname]),s.useEffect(()=>(sessionStorage.setItem("inCreateDealFlow","true"),()=>{window.location.pathname.includes("/create-deal")||(sessionStorage.removeItem("inCreateDealFlow"),sessionStorage.removeItem("currentStep"))}),[t]);const _=(e,i)=>{(g||e<=m)&&(e>m&&t(k(e)),n(i))};return c.jsx(O,{steps:y,currentStep:m,navigationAllow:g,activeStep:I,isComparablesRoute:E,onStepClick:_,deal:a})};export{H as default};
