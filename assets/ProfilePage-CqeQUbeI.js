import{r as s,m as e,Q as ve,S as Ne,T as Ce,U as ke,u as ae,s as Se,q as Fe,V as se,W as Me,X as Pe,Y as ne,o as oe,Z as Le,_ as Ee,x as re,$ as Ue}from"./index-BgTlmKzg.js";import{u as Ie}from"./useRefreshUser-BuW44WBU.js";import{M as le}from"./Modal-BRslThQs.js";import{c as De,X as $e}from"./x-DSs8glc9.js";const Oe="/assets/company-logo-baJq8U9U.png";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],We=De("check",Re),qe=({isOpen:t,onClose:d,imageSrc:I,onCropComplete:D,aspectRatio:x=1})=>{const[y,F]=s.useState({x:0,y:0}),[w,A]=s.useState(1),[H,q]=s.useState(!1),[P,V]=s.useState({x:0,y:0}),T=s.useRef(null),M=s.useRef(null),N=s.useRef(null);s.useEffect(()=>{if(t&&I){const n=new Image;n.onload=()=>{N.current=n,X()},n.src=I}},[t,I,y,w]);const X=()=>{const n=T.current,u=N.current;if(!n||!u)return;const o=n.getContext("2d"),j=M.current;if(!j)return;const m=j.offsetWidth,i=j.offsetHeight;n.width=m,n.height=i,o.fillStyle="rgba(0, 0, 0, 0.5)",o.fillRect(0,0,m,i);const C=Math.min(m/u.width,i/u.height)*w,r=u.width*C,v=u.height*C,h=(m-r)/2+y.x,k=(i-v)/2+y.y;o.save(),o.globalCompositeOperation="destination-out";const g=Math.min(m,i)*.7,b=(m-g)/2,S=(i-g)/2;x===1?(o.beginPath(),o.arc(m/2,i/2,g/2,0,Math.PI*2),o.fill()):o.fillRect(b,S,g,g/x),o.restore(),o.globalCompositeOperation="destination-over",o.drawImage(u,h,k,r,v),o.globalCompositeOperation="source-over",o.strokeStyle="#fff",o.lineWidth=2,x===1?(o.beginPath(),o.arc(m/2,i/2,g/2,0,Math.PI*2),o.stroke()):o.strokeRect(b,S,g,g/x)},L=n=>{q(!0),V({x:n.clientX-y.x,y:n.clientY-y.y})},G=n=>{H&&F({x:n.clientX-P.x,y:n.clientY-P.y})},z=()=>{q(!1)},Y=s.useCallback(async()=>{const n=N.current,u=M.current;if(!n||!u)return;const o=u.offsetWidth,j=u.offsetHeight,m=Math.min(o/n.width,j/n.height)*w,i=n.width*m,C=n.height*m,r=(o-i)/2+y.x,v=(j-C)/2+y.y,h=Math.min(o,j)*.7,k=(o-h)/2,g=(j-h)/2,b=document.createElement("canvas");b.width=h,b.height=h/x;const S=b.getContext("2d"),$=(k-r)/m,O=(g-v)/m,E=h/m,R=h/x/m;S.drawImage(n,$,O,E,R,0,0,h,h/x),b.toBlob(U=>{D(U),d()},"image/jpeg",.95)},[y,w,x,D,d]);return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:"Crop Image"}),e.jsx("div",{ref:M,className:"relative h-96 bg-gray-100 dark:bg-gray-700 rounded-lg mb-4 overflow-hidden cursor-move",onMouseDown:L,onMouseMove:G,onMouseUp:z,onMouseLeave:z,children:e.jsx("canvas",{ref:T,className:"w-full h-full"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zoom"}),e.jsx("input",{type:"range",min:1,max:3,step:.1,value:w,onChange:n=>A(parseFloat(n.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[e.jsx($e,{size:16})," Cancel"]}),e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-4 py-2 bg-[#6C5DD3] text-white rounded-lg",children:[e.jsx(We,{size:16}),"  Save"]})]})]})})}):null},Te=Ne("pk_test_51R6uLuGhmABE4SukbmgqsLITna4D57Ittag620AxGwm1ckI0oeYBXvNUBO9w4WhygDlp3sWd7ldWiZlGbR8jzxXk00N3jUSXPv"),Xe=()=>{Ce(),ke();const{user:t,role:d}=ae(a=>a.user),{darkMode:I}=ae(a=>a.theme),D="https://phplaravel-1547671-6035260.cloudwaysapps.com/storage";Se();const{showSnackbar:x}=Fe(),y=Ie(),[F,w]=s.useState(!1),[A,H]=s.useState(!1),[q,P]=s.useState(!1),[V,T]=s.useState(!1),[M,N]=s.useState(null),[X,L]=s.useState(null),[G,z]=s.useState({current:!1,new:!1,confirm:!1}),[Y,n]=s.useState(!1),[u,o]=s.useState(!1),[j,m]=s.useState([]),[i,C]=s.useState(!1),[r,v]=s.useState(!(t!=null&&t.company_name)||!(t!=null&&t.sub_domain)),[h,k]=s.useState(!1),[g,b]=s.useState(null),[S,$]=s.useState(null),[O,E]=s.useState(null),[R,U]=s.useState(null),{register:_,handleSubmit:Z,formState:{errors:c},reset:W,control:ie,setValue:ze,setFocus:B}=se({defaultValues:{first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",role:d||"",company_name:(t==null?void 0:t.company_name)||"",registration_number:(t==null?void 0:t.registration_number)||"",company_website:(t==null?void 0:t.company_website)||"",company_email:(t==null?void 0:t.company_email)||"",company_phone:(t==null?void 0:t.company_phone)||"",sub_domain:(t==null?void 0:t.sub_domain)||""}}),ce=Me({control:ie,name:"sub_domain"}),{register:Ye,handleSubmit:Ae,formState:{errors:He},reset:Ve}=se();s.useEffect(()=>{t&&(W({first_name:t.first_name||"",last_name:t.last_name||"",email:t.email||"",phone:t.phone||"",role:d||"",company_name:t.company_name||"",registration_number:t.registration_number||"",company_website:t.company_website||"",company_email:t.company_email||"",company_phone:t.company_phone||"",sub_domain:(t==null?void 0:t.sub_domain)||""}),t.profile_image&&N(t.profile_image),t.company_logo_url&&L(t.company_logo_url),t.stripe_customer_id&&me(t.stripe_customer_id))},[t,W,d]);const me=async a=>{try{P(!0);const l=await Pe(a);l&&l.data&&m(l.data)}catch(l){console.error("Error fetching cards:",l),x("Failed to load payment methods","error")}finally{P(!1)}},de=a=>{const l=a.target.files[0];if(l){const p=new FileReader;p.onload=()=>{b(p.result),$("profile"),k(!0)},p.readAsDataURL(l)}a.target.value=""},pe=a=>{const l=a.target.files[0];if(l){const p=new FileReader;p.onload=()=>{b(p.result),$("company"),k(!0)},p.readAsDataURL(l)}a.target.value=""},fe=a=>{const l=new File([a],"cropped-image.jpg",{type:"image/jpeg"}),p=URL.createObjectURL(a);S==="profile"?(E(l),N(p)):S==="company"&&(U(l),L(p))},J=async(a,l=!1,p=!1)=>{var Q,ee;if(!(!l&&!p))try{w(!0);const f=new FormData;f.append("_method","PATCH"),l&&(f.append("first_name",a.first_name),f.append("last_name",a.last_name),f.append("phone",a.phone),O&&f.append("profile_image",O)),p&&(a.company_name&&f.append("company_name",a.company_name),a.company_website&&f.append("company_website",a.company_website),a.company_email&&f.append("company_email",a.company_email),a.company_phone&&f.append("company_phone",a.company_phone),a.sub_domain&&f.append("sub_domain",a.sub_domain),R&&f.append("company_logo",R)),(await Ue(f)).data&&(x(l&&p?"Profile & Company updated successfully":l?"Profile updated successfully":"Company updated successfully","success"),await y(),E(null),U(null),l&&C(!1),p&&v(!1))}catch(f){console.error("Update error:",f);const te=((ee=(Q=f.response)==null?void 0:Q.data)==null?void 0:ee.message)||"Failed to update";x(te,"error")}finally{w(!1)}},xe=a=>J(a,!0,!1),ue=a=>J(a,!1,!0),he=()=>{i&&(W({first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",phone:(t==null?void 0:t.phone)||""}),E(null),N((t==null?void 0:t.profile_image)||null)),C(a=>!a)},ge=()=>{r&&(W({company_name:(t==null?void 0:t.company_name)||"",company_website:(t==null?void 0:t.company_website)||"",company_email:(t==null?void 0:t.company_email)||"",company_phone:(t==null?void 0:t.company_phone)||"",sub_domain:(t==null?void 0:t.sub_domain)||""}),U(null),L((t==null?void 0:t.company_logo_url)||null)),v(a=>!a)},ye=a=>a?a.startsWith("blob:")||a.startsWith("http")?a:`${D}/${a}`:null,be=a=>a?a.split("-").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" "):"Not Assigned";function je(){if(typeof window>"u")return"visionvivante.in";const a=window.location.hostname.split(".");return a.length>2?a.slice(1).join("."):window.location.hostname}const K=je();function _e(a){return`https://${a!=null&&a.trim()?a.toLowerCase().trim().replace(/\s+/g,""):"your-company"}.${K}`}const we=_e(ce);return s.useEffect(()=>{t&&d!=="investor"&&d!=="team"&&d!=="team-lead"&&(!t.company_name||!t.sub_domain||!t.company_email||!t.company_phone)&&v(!0)},[t,d]),s.useEffect(()=>{r&&(!(t!=null&&t.company_name)||!(t!=null&&t.sub_domain))&&setTimeout(()=>{B("company_name")},0)},[r,t,B]),e.jsx("div",{className:"min-h-screen my-5",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b dark:border-b-[#333333]",children:[e.jsx("h1",{className:"text-3xl text-black dark:text-white",children:"My Profile"}),e.jsx("button",{type:"button",onClick:he,className:"flex items-center gap-2 border rounded-lg px-2 py-2 text-black cursor-pointer dark:text-[#F8F8F8] dark:border-[#333333] dark:bg-[#121212]",children:i?e.jsxs(e.Fragment,{children:[e.jsx(ne,{})," Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{})," Edit Profile"]})})]}),e.jsx("div",{className:"flex justify-start mt-8 ml-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:M?e.jsx("img",{src:ye(M),alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(Le,{className:"w-full h-full text-[#6C5DD3]"})}),i&&e.jsxs("label",{htmlFor:"profileImage",className:"border rounded-lg px-4 py-2 text-black dark:text-white cursor-pointer",children:["Upload Image",e.jsx("input",{type:"file",id:"profileImage",className:"hidden",accept:"image/*",onChange:de})]})]})}),e.jsx("form",{onSubmit:Z(xe),children:e.jsx("div",{className:"profile-detail-form-container-main-div",children:e.jsxs("div",{className:"dark:bg-[#181818] bg-[#fff] profile-detail-form-container-wrap",children:[e.jsxs("div",{className:"w-[100%] md:w-[60%]",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"First Name"}),e.jsx("input",{type:"text",..._("first_name",{required:"First name is required"}),readOnly:!i,className:`form-control w-full ${c.first_name?"border border-red-500":""} ${i?"":"opacity-75 cursor-not-allowed"}`}),c.first_name&&i&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.first_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Last Name"}),e.jsx("input",{type:"text",..._("last_name",{required:"Last name is required"}),readOnly:!i,className:`form-control w-full ${c.last_name?"border border-red-500":""} ${i?"":"opacity-75 cursor-not-allowed"}`}),c.last_name&&i&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.last_name.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Email"}),e.jsx("input",{type:"email",..._("email"),disabled:!0,className:"form-control w-full opacity-75 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Phone Number"}),e.jsx("input",{type:"tel",..._("phone"),readOnly:!i,className:`form-control w-full ${c.phone?"border border-red-500":""} ${i?"":"opacity-75 cursor-not-allowed"}`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 mt-5 inline-block",children:"Role:"}),e.jsxs("div",{className:"relative opacity-75 cursor-not-allowed",children:[e.jsx("input",{type:"text",className:"form-control w-full cursor-not-allowed",value:be(d),readOnly:!0,style:{paddingLeft:"40px"}}),e.jsx("span",{className:"inline-block absolute left-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-purple",children:e.jsx(Ee,{})})]})]})]}),i&&e.jsx("div",{className:"text-right mb-8 mt-5",children:e.jsx("button",{type:"submit",className:"purple-btn flex items-center gap-2 ml-auto",disabled:F,children:F?e.jsx(re,{size:20}):e.jsx(e.Fragment,{children:" Save Profile Changes"})})})]})})}),d!=="investor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b dark:border-b-[#333333] mt-10",children:[e.jsx("h1",{className:"text-xl text-black dark:text-[#F8F8F8]",children:"Company Details"}),d!=="team"&&d!=="team-lead"&&e.jsx("button",{type:"button",onClick:ge,className:"flex items-center gap-2 border rounded-lg px-2 py-2 text-black cursor-pointer dark:text-[#F8F8F8] dark:border-[#333333] dark:bg-[#121212]",children:r?e.jsxs(e.Fragment,{children:[e.jsx(ne,{})," Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{})," Edit Company"]})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 p-5",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:e.jsx("img",{src:X||Oe,alt:"Company Logo",className:"w-full h-full object-cover"})}),r&&e.jsxs("label",{className:"border rounded-lg px-4 py-2 text-black dark:text-white cursor-pointer",children:["Upload Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:pe})]})]}),e.jsxs("form",{onSubmit:Z(ue),children:[e.jsx("div",{className:"dark:bg-[#181818] bg-[#fff] profile-detail-form-container-wrap",children:e.jsxs("div",{className:"w-[100%] md:w-[60%]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Name"}),e.jsx("input",{type:"text",..._("company_name",{required:"Company name is required"}),readOnly:!r,placeholder:"Enter company name",className:`form-control w-full ${c.company_name?"border border-red-500":""} ${r?"":"opacity-75 cursor-not-allowed"}`}),c.company_name&&r&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.company_name.message})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] my-2 inline-block",children:"Sub Domain"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"your-company",..._("sub_domain",{required:"Sub domain is required",pattern:{value:new RegExp("^(?!-)[a-z0-9-]{1,63}(?<!-)$"),message:"Use only lowercase letters, numbers, and hyphens (cannot start or end with hyphen)"}}),readOnly:!r,className:`form-control w-full pr-48 ${c.sub_domain?"border border-red-500":""} ${r?"":"opacity-75 cursor-not-allowed"}`}),e.jsxs("span",{className:"absolute inset-y-0 right-3 flex items-center text-gray-500 text-sm font-medium pointer-events-none",children:[".",K]})]}),c.sub_domain&&r&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.sub_domain.message}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Your app will be available at:"," ",e.jsx("strong",{className:"text-[#6C5DD3]",children:we})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-7 mt-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Email"}),e.jsx("input",{type:"email",..._("company_email",{required:"Company email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Enter a valid email address"}}),readOnly:!r,placeholder:"Enter company email",className:`form-control w-full ${c.company_email?"border border-red-500":""} ${r?"":"opacity-75 cursor-not-allowed"}`}),c.company_email&&r&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.company_email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Phone"}),e.jsx("input",{type:"tel",..._("company_phone",{required:"Company phone is required",pattern:{value:/^(\+44|0044|0)\s?7\d{3}\s?\d{6}$|^(\+44|0044|0)\s?(1\d{1}|2\d{1}|3\d{1}|8\d{1})\d{2}\s?\d{6}$/,message:"Enter a valid UK phone number"}}),readOnly:!r,placeholder:"Enter phone number",className:`form-control w-full ${c.company_phone?"border border-red-500":""} ${r?"":"opacity-75 cursor-not-allowed"}`}),c.company_phone&&r&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.company_phone.message})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("label",{className:"text-md text-[#333] dark:text-[#fff] mb-2 inline-block",children:"Company Website"}),e.jsx("input",{type:"text",..._("company_website"),readOnly:!r,placeholder:"Enter Company website",className:`form-control w-full ${r?"":"opacity-75 cursor-not-allowed"}`})]})]})}),r&&e.jsx("div",{className:"text-right mb-8",children:e.jsx("button",{type:"submit",className:"purple-btn flex items-center gap-2 ml-auto",disabled:F,children:F?e.jsx(re,{size:20}):e.jsx(e.Fragment,{children:" Save Company Changes"})})})]})]}),e.jsx(le,{isOpen:Y,onClose:()=>n(!1),title:"Change Password"}),e.jsx(le,{isOpen:u,onClose:()=>o(!1),title:"Update Payment Method"}),e.jsx(qe,{isOpen:h,onClose:()=>k(!1),imageSrc:g,onCropComplete:fe,aspectRatio:1})]})})},Ke=()=>e.jsx(ve,{stripe:Te,children:e.jsx(Xe,{})});export{Ke as default};
