import{t as De,r as o,u as H,m as e,n as ee,F as te,o as se,p as re,q as Ue,a4 as Ye,a5 as ze,a6 as Ve,a7 as Ge,s as Qe,a8 as We,a9 as ge,G as qe,y as Je,x as Ke,A as Xe,aa as Ze,ab as pe,H as be,I as je,J as ye,K as ve,M as _e,B as et,C as tt,D as we,ac as st,E as rt,N as nt,O as at}from"./index-Bbk-TWcL.js";import{S as ke}from"./SendContactDealModal-DbgpEIDK.js";import{D as ot}from"./DeleteConfirmationModal-BVv8qqWx.js";import{A as ne,a as ae}from"./index-CGxdH-oH.js";import{A as oe,m as ie}from"./proxy-C1LgloiJ.js";import{P as it}from"./PaginationNew-C13B61bS.js";import{A as lt}from"./ArchiveConfirmationModal-DIkOnyYw.js";import{H as ct}from"./index-BCefSaD0.js";import{l as dt}from"./lodash-DBK4TVW_.js";const pt=({deals:a=[],selectedDeals:_,setSelectedDeals:w,handleSelectDeal:I,pagination:j,filters:Y,handleSort:M,handleViewDeal:R,handleEditDeal:C,openDeleteConfirmation:O,formatAddress:k,getDealDescription:L,archive:p,openArchiveConfirmation:T})=>{const i=De(),[c,g]=o.useState(null),[m,h]=o.useState({top:0,left:0}),[U,P]=o.useState(!1),S=o.useRef(null),A=o.useRef({}),{user:D,role:B}=H(s=>s.user),t=()=>{i("/")};o.useEffect(()=>{function s(F){S.current&&!S.current.contains(F.target)&&g(null)}function u(){c!==null&&g(null)}function d(){if(c!==null&&A.current[c]){const E=A.current[c].getBoundingClientRect(),le=window.innerHeight-E.bottom,y=E.top;P(le<200&&y>200),h({top:U?E.top-10:E.bottom+5,left:E.right-160})}}return d(),document.addEventListener("mousedown",s),document.addEventListener("scroll",u,!0),window.addEventListener("resize",d),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("scroll",u,!0),window.removeEventListener("resize",d)}},[c,U]);const l=s=>(s==null?void 0:s.deal_type_id)===2?"Service accommodation (SA)":(s==null?void 0:s.deal_type_id)===3?"Single Let":(s==null?void 0:s.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"dark:!bg-[#181818] dark:text-[#A1A1A1] text-black",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:s=>{if(s.target.checked){const u=a.filter(d=>d.step_completed===5).map(d=>d.id);w(u)}else w([])},checked:a.filter(s=>s.step_completed===5).length>0&&a.filter(s=>s.step_completed===5).every(s=>_.includes(s.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.length>0?a.map((s,u)=>{var d,F;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:_.includes(s.id),onChange:()=>I(s.id),disabled:s.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{C(s.id,s==null?void 0:s.step_completed),t()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:k(s)})}),e.jsx("td",{children:(s==null?void 0:s.property_type_category_name)||""}),e.jsx("td",{children:(d=s.property_deal_investment)!=null&&d.return_on_cash_investment_percentage?`${parseFloat(s.property_deal_investment.return_on_cash_investment_percentage).toFixed(0)}%`:(F=s.property_deal_sa_investment)!=null&&F.net_roi_percentage?`${parseFloat(s.property_deal_sa_investment.net_roi_percentage).toFixed(0)}%`:"0%"}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:l(s)||(s==null?void 0:s.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p==="archive"?"bg-red-100 text-red-700 border border-red-300":s.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:p==="archive"?s.status:s.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:s.created_at?new Date(s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{className:"flex justify-center relative",children:e.jsx("button",{ref:E=>A.current[s.id]=E,onClick:()=>g(c===s.id?null:s.id),className:"text-lg",children:e.jsx(ee,{className:"text-[#595959]"})})})})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(oe,{children:c!==null&&e.jsxs(ie.div,{ref:S,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${m.top}px`,left:`${m.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[p!=="archive"&&e.jsxs("button",{onClick:()=>{const s=a.find(u=>u.id===c);R(s),g(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ne,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const s=a.find(u=>u.id===c);C(s==null?void 0:s.id,s==null?void 0:s.step_completed),g(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:p==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(te,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(se,{className:"mr-2"})," Edit"]})}),p!=="archive"&&e.jsxs("button",{onClick:()=>{T(c),g(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Archive Deal"]}),B!=="team"&&e.jsxs("button",{onClick:()=>{O(c),g(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(re,{className:"mr-2"})," Delete"]})]})})]})},ut=({deals:a=[],selectedDeals:_,setSelectedDeals:w,handleSelectDeal:I,pagination:j,filters:Y,handleSort:M,handleViewDeal:R,handleEditDeal:C,openDeleteConfirmation:O,formatAddress:k,getDealDescription:L,archive:p,openArchiveConfirmation:T})=>{const[i,c]=o.useState(null),[g,m]=o.useState(!1),h=o.useRef(null),{user:U,role:P}=H(t=>t.user);o.useEffect(()=>{function t(l){h.current&&!h.current.contains(l.target)&&c(null)}if(i!==null&&h.current){const l=h.current.getBoundingClientRect(),s=window.innerHeight-l.bottom;m(s<150)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[i]);const[S,A]=o.useState({top:0,left:0}),D=o.useRef({});o.useEffect(()=>{function t(u){h.current&&!h.current.contains(u.target)&&c(null)}function l(){i!==null&&c(null)}function s(){if(i!==null&&D.current[i]){const d=D.current[i].getBoundingClientRect(),F=window.innerHeight-d.bottom,E=d.top;m(F<200&&E>200),A({top:g?d.top-10:d.bottom+5,left:d.right-160})}}return s(),document.addEventListener("mousedown",t),document.addEventListener("scroll",l,!0),window.addEventListener("resize",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("scroll",l,!0),window.removeEventListener("resize",s)}},[i,g]);const B=t=>(t==null?void 0:t.deal_type_id)===2?"Service accommodation (SA)":(t==null?void 0:t.deal_type_id)===3?"Single Let":(t==null?void 0:t.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:`${a.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const l=a.filter(s=>s.step_completed===5).map(s=>s.id);w(l)}else w([])},checked:a.filter(t=>t.step_completed===5).length>0&&a.filter(t=>t.step_completed===5).every(t=>_.includes(t.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.length>0?a.map((t,l)=>{var s,u;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:_.includes(t.id),onChange:()=>I(t.id),disabled:t.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{C(t.id,t==null?void 0:t.step_completed),handleAddressView()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:k(t)})}),e.jsx("td",{children:(t==null?void 0:t.property_type_category_name)||""}),e.jsx("td",{children:(s=t.property_deal_investment)!=null&&s.return_on_cash_investment_percentage?`${parseFloat(t.property_deal_investment.return_on_cash_investment_percentage).toFixed(2)}%`:(u=t.property_deal_sa_investment)!=null&&u.net_roi_percentage?`${parseFloat(t.property_deal_sa_investment.net_roi_percentage).toFixed(2)}%`:"0%"}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:B(t)||(t==null?void 0:t.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p==="archive"?"bg-red-100 text-red-700 border border-red-300":t.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:p==="archive"?t.status:t.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{id:`dropdown-${t.id}`,className:"flex justify-center relative",children:e.jsx("button",{ref:d=>D.current[t.id]=d,onClick:()=>c(i===t.id?null:t.id),className:"text-lg",children:e.jsx(ee,{className:"text-[#595959]"})})})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(oe,{children:i!==null&&e.jsxs(ie.div,{ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${S.top}px`,left:`${S.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[p!=="archive"&&e.jsxs("button",{onClick:()=>{const t=a.find(l=>l.id===i);R(t),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ne,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const t=a.find(l=>l.id===i);C(t==null?void 0:t.id,t==null?void 0:t.step_completed),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:p==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(te,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(se,{className:"mr-2"})," Edit"]})}),p!=="archive"&&e.jsxs("button",{onClick:()=>{T(i),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Archive Deal"]}),P!=="team"&&e.jsxs("button",{onClick:()=>{O(i),c(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(re,{className:"mr-2"})," Delete"]})]})})]})},xt=({deals:a=[],selectedDeals:_,setSelectedDeals:w,handleSelectDeal:I,pagination:j,filters:Y,handleSort:M,handleViewDeal:R,handleEditDeal:C,openDeleteConfirmation:O,formatAddress:k,getDealDescription:L,archive:p,openArchiveConfirmation:T})=>{const[i,c]=o.useState(null),[g,m]=o.useState(!1),h=o.useRef(null),{user:U,role:P}=H(t=>t.user);o.useEffect(()=>{function t(l){h.current&&!h.current.contains(l.target)&&c(null)}if(i!==null&&h.current){const l=h.current.getBoundingClientRect(),s=window.innerHeight-l.bottom;m(s<150)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[i]);const[S,A]=o.useState({top:0,left:0}),D=o.useRef({});o.useEffect(()=>{function t(u){h.current&&!h.current.contains(u.target)&&c(null)}function l(){i!==null&&c(null)}function s(){if(i!==null&&D.current[i]){const d=D.current[i].getBoundingClientRect(),F=window.innerHeight-d.bottom,E=d.top;m(F<200&&E>200),A({top:g?d.top-10:d.bottom+5,left:d.right-160})}}return s(),document.addEventListener("mousedown",t),document.addEventListener("scroll",l,!0),window.addEventListener("resize",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("scroll",l,!0),window.removeEventListener("resize",s)}},[i,g]);const B=t=>(t==null?void 0:t.deal_type_id)===2?"Service accommodation (SA)":(t==null?void 0:t.deal_type_id)===3?"Single Let":(t==null?void 0:t.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:`${a.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const l=a.filter(s=>s.step_completed===5).map(s=>s.id);w(l)}else w([])},checked:a.filter(t=>t.step_completed===5).length>0&&a.filter(t=>t.step_completed===5).every(t=>_.includes(t.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.length>0?a.map((t,l)=>{var s,u;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:_.includes(t.id),onChange:()=>I(t.id),disabled:t.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{C(t.id,t==null?void 0:t.step_completed),handleAddressView()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:k(t)})}),e.jsx("td",{children:(t==null?void 0:t.property_type_category_name)||""}),e.jsx("td",{children:(s=t.property_deal_investment)!=null&&s.return_on_cash_investment_percentage?`${parseFloat(t.property_deal_investment.return_on_cash_investment_percentage).toFixed(2)}%`:(u=t.property_deal_sa_investment)!=null&&u.net_roi_percentage?`${parseFloat(t.property_deal_sa_investment.net_roi_percentage).toFixed(2)}%`:"0%"}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:B(t)||(t==null?void 0:t.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p==="archive"?"bg-red-100 text-red-700 border border-red-300":t.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:p==="archive"?t.status:t.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{id:`dropdown-${t.id}`,className:"flex justify-center relative",children:e.jsx("button",{ref:d=>D.current[t.id]=d,onClick:()=>c(i===t.id?null:t.id),className:"text-lg",children:e.jsx(ee,{className:"text-[#595959]"})})})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(oe,{children:i!==null&&e.jsxs(ie.div,{ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${S.top}px`,left:`${S.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[p!=="archive"&&e.jsxs("button",{onClick:()=>{const t=a.find(l=>l.id===i);R(t),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ne,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const t=a.find(l=>l.id===i);C(t==null?void 0:t.id,t==null?void 0:t.step_completed),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:p==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(te,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(se,{className:"mr-2"})," Edit"]})}),p!=="archive"&&e.jsxs("button",{onClick:()=>{T(i),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Archive Deal"]}),P!=="team"&&e.jsxs("button",{onClick:()=>{O(i),c(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(re,{className:"mr-2"})," Delete"]})]})})]})},ht=({deals:a=[],selectedDeals:_,setSelectedDeals:w,handleSelectDeal:I,pagination:j,filters:Y,handleSort:M,handleViewDeal:R,handleEditDeal:C,openDeleteConfirmation:O,formatAddress:k,getDealDescription:L,archive:p,openArchiveConfirmation:T})=>{const[i,c]=o.useState(null),[g,m]=o.useState(!1),h=o.useRef(null),{user:U,role:P}=H(t=>t.user);o.useEffect(()=>{function t(l){h.current&&!h.current.contains(l.target)&&c(null)}if(i!==null&&h.current){const l=h.current.getBoundingClientRect(),s=window.innerHeight-l.bottom;m(s<150)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[i]);const[S,A]=o.useState({top:0,left:0}),D=o.useRef({});o.useEffect(()=>{function t(u){h.current&&!h.current.contains(u.target)&&c(null)}function l(){i!==null&&c(null)}function s(){if(i!==null&&D.current[i]){const d=D.current[i].getBoundingClientRect(),F=window.innerHeight-d.bottom,E=d.top;m(F<200&&E>200),A({top:g?d.top-10:d.bottom+5,left:d.right-160})}}return s(),document.addEventListener("mousedown",t),document.addEventListener("scroll",l,!0),window.addEventListener("resize",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("scroll",l,!0),window.removeEventListener("resize",s)}},[i,g]);const B=t=>(t==null?void 0:t.deal_type_id)===2?"Service accommodation (SA)":(t==null?void 0:t.deal_type_id)===3?"Single Let":(t==null?void 0:t.deal_type_id)===5?"House in multiple occupation(HMO)":"";return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:`${a.length<3?"overflow-dropdown-issue":""}  w-full text-left border-collapse`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",onChange:t=>{if(t.target.checked){const l=a.filter(s=>s.step_completed===5).map(s=>s.id);w(l)}else w([])},checked:a.filter(t=>t.step_completed===5).length>0&&a.filter(t=>t.step_completed===5).every(t=>_.includes(t.id))})}),e.jsx("th",{children:"PROPERTY ADDRESS"}),e.jsx("th",{children:"PROPERTY CATEGORY"}),e.jsx("th",{children:"ROI"}),e.jsx("th",{children:"DEAL TYPE"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"DEAL CREATED"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.length>0?a.map((t,l)=>{var s,u;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:_.includes(t.id),onChange:()=>I(t.id),disabled:t.step_completed!==5})}),e.jsx("td",{children:e.jsx("div",{onClick:()=>{C(t.id,t==null?void 0:t.step_completed),handleAddressView()},className:"cursor-pointer line-clamp-3 max-w-[200px] overflow-hidden text-ellipsis",children:k(t)})}),e.jsx("td",{children:(t==null?void 0:t.property_type_category_name)||""}),e.jsx("td",{children:(s=t.property_deal_investment)!=null&&s.return_on_cash_investment_percentage?`${parseFloat(t.property_deal_investment.return_on_cash_investment_percentage).toFixed(2)}%`:(u=t.property_deal_sa_investment)!=null&&u.net_roi_percentage?`${parseFloat(t.property_deal_sa_investment.net_roi_percentage).toFixed(2)}%`:"0%"}),e.jsx("td",{children:e.jsx("span",{className:"border border-[#E2E8F0] rounded-xl bg-[#F8FAFC] px-2 py-1 text-xs text-[#334155] dark:bg-[#020617] dark:text-[#CBD5E1] dark:border-[#1E293B]",children:B(t)||(t==null?void 0:t.deal_type_name)||""})}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p==="archive"?"bg-red-100 text-red-700 border border-red-300":t.status==="publish"?"bg-[#F7FEE7] text-[#4D7C0F] border border-[#D9F99D] dark:bg-[#3F6212] dark:text-[#BEF264]":"bg-[#F8FAFC] text-[#334155] border border-[#E2E8F0] dark:border-[#1E293B] dark:bg-[#020617] dark:text-[#CBD5E1]"}`,children:p==="archive"?t.status:t.status==="publish"?"Published":"Draft"})}),e.jsx("td",{children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"-"}),e.jsx("td",{className:"relative",children:e.jsx("div",{id:`dropdown-${t.id}`,className:"flex justify-center relative",children:e.jsx("button",{ref:d=>D.current[t.id]=d,onClick:()=>c(i===t.id?null:t.id),className:"text-lg",children:e.jsx(ee,{className:"text-[#595959]"})})})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center p-4",children:"No deals available"})})})]}),e.jsx(oe,{children:i!==null&&e.jsxs(ie.div,{ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},style:{position:"fixed",top:`${S.top}px`,left:`${S.left}px`,zIndex:9999},className:"w-40 bg-white border rounded shadow-lg dark:bg-[#242424] dark:border-none dark:rounded-[16px]",children:[p!=="archive"&&e.jsxs("button",{onClick:()=>{const t=a.find(l=>l.id===i);R(t),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ne,{className:"mr-2"})," View"]}),e.jsx("button",{onClick:()=>{const t=a.find(l=>l.id===i);C(t==null?void 0:t.id,t==null?void 0:t.step_completed),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:p==="archive"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(te,{className:"mr-2"})," Restore"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(se,{className:"mr-2"})," Edit"]})}),p!=="archive"&&e.jsxs("button",{onClick:()=>{T(i),c(null)},className:"flex items-center w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(ae,{className:"mr-2"})," Archive Deal"]}),P!=="team"&&e.jsxs("button",{onClick:()=>{O(i),c(null)},className:"flex items-center w-full px-4 py-2 text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",children:[e.jsx(re,{className:"mr-2"})," Delete"]})]})})]})},mt=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"",Nt=()=>{const[a,_]=o.useState("all"),{user:w,role:I}=H(r=>r.user),[j,Y]=o.useState("all"),M=De(),[R,C]=o.useState([]);H(r=>r.deal.currentStep),H(r=>r.deal.dealFilters);const O=H(r=>r.deal.dealsTypes),[k,L]=o.useState([]),{showSnackbar:p}=Ue(),[T,i]=o.useState(!1),[c,g]=o.useState(!1),[m,h]=o.useState(0),[U,P]=o.useState(!1),[S,A]=o.useState(!1),[D,B]=o.useState(null),[t,l]=o.useState(null),[s,u]=o.useState(!1),[d,F]=o.useState(!1),[E,le]=o.useState(""),[y,Ee]=o.useState({currentPage:1,totalPages:1,from:0,to:0,total:0,hasMorePages:!1}),Ne=[{label:"Total deals",status:"all",icon:e.jsx(Ye,{className:"text-lg text-[#595959] dark:text-[#C5C5C5]"}),count:m==null?void 0:m.all},{label:"Draft deals",status:"draft",icon:e.jsx(ct,{className:"text-2xl text-[#595959] dark:text-[#C5C5C5]"}),count:m==null?void 0:m.draft},{label:"Published deals",status:"publish",icon:e.jsx(ze,{className:"text-2xl text-[#595959] dark:text-[#C5C5C5]"}),count:m==null?void 0:m.publish},{label:"Archived deals",status:"archive",icon:e.jsx(Ve,{className:"text-2xl text-[#595959] dark:text-[#C5C5C5]"}),count:m==null?void 0:m.archive}];o.useEffect(()=>{z(r=>({...r,status:j==="all"?"all":j,page:1}))},[j]),o.useEffect(()=>{var n,f;const r=a==="all"?1:((f=(n=O==null?void 0:O.deal_types)==null?void 0:n.find(v=>v.slug===a))==null?void 0:f.id)??null;z(v=>({...v,dealTypeId:r,page:1}))},[a]);const[b,z]=o.useState({per_page:(y==null?void 0:y.total)>=10||(y==null?void 0:y.total)==0?10:(y==null?void 0:y.total)||1,page:1,status:"",year:"",propertyTypeId:"",dealTypeId:"",search:"",sortColumn:"created_at",sortOrder:"desc"}),{data:ce,loading:Se}=Ge(Ze),N=Qe(),V=async()=>{var r,n;try{g(!0);const f={page:b.page,perPage:b.per_page,status:b.status===""?null:b.status,year:b.year===""?null:b.year,propertyTypeId:b.propertyTypeId===""?null:b.propertyTypeId,sortColumn:b.sortColumn,sortOrder:b.sortOrder,search:b.search===""?null:b.search};a!=="all"&&a!=="tab"&&(f.dealTypeId=b.dealTypeId);const v=await Xe(f);if(v&&v.data){h((n=(r=v==null?void 0:v.data)==null?void 0:r.data)==null?void 0:n.dealsCount),C(v.data.data.deals||[]);const x=v.data.data.page_context;x&&Ee({currentPage:parseInt(x==null?void 0:x.page)||1,totalPages:Math.ceil(parseInt((x==null?void 0:x.total_records)||0)/parseInt((x==null?void 0:x.per_page)||10)),from:(parseInt(x.page)-1)*parseInt(x.per_page)+1,to:Math.min(parseInt(x==null?void 0:x.page)*parseInt(x==null?void 0:x.per_page),parseInt((x==null?void 0:x.total_records)||0)),total:parseInt((x==null?void 0:x.total_records)||0),hasMorePages:(x==null?void 0:x.has_more_page)==="true"})}}catch{p("Failed to fetch deals. Please try again.","error")}finally{g(!1)}},Fe=dt.debounce(r=>{z(n=>({...n,search:r,page:1}))},1e3),Ce=r=>{const n=r.target.value;le(n),Fe(n)};o.useEffect(()=>{b.dealTypeId&&V()},[b]);const G=r=>{L(n=>n.includes(r)?n.filter(f=>f!==r):[...n,r])},Ae=()=>{if(k.length===0){p("Please select at least one deal.","error");return}i(!0)},Re=()=>{i(!1)},Q=r=>{z(n=>({...n,sortColumn:r,sortOrder:n.sortColumn===r&&n.sortOrder==="asc"?"desc":"asc",page:1}))},W=async r=>{const n={user_id:r==null?void 0:r.user_id,property_deal_id:r==null?void 0:r.id};r.deal_type_id==2?(await we(n),M(`/deals/deal-view/${r.id}`)):(await we(n),M(`/deals/deal-view/${r.id}`))},q=r=>{B(r),P(!0)},J=r=>{l(r),A(!0)},K=async r=>{var n;try{g(!0);const f=await st(r);f?(p((n=f==null?void 0:f.data)==null?void 0:n.message),V()):p("Failed to restore deal","error")}catch(f){console.error("Restore failed:",f),p("Something went wrong","error")}finally{g(!1)}},Oe=async()=>{var r;if(t)try{F(!0);let n=await tt(t);p((r=n==null?void 0:n.data)==null?void 0:r.message),V(),A(!1),l(null)}catch(n){console.error("Error deleting deal:",n),p("Failed to delete deal",n)}finally{F(!1)}},Pe=async()=>{var r;if(D)try{u(!0);let n=await et(D);p((r=n==null?void 0:n.data)==null?void 0:r.message),V(),P(!1),B(null)}catch(n){console.error("Error deleting deal:",n),p("Failed to delete deal","error")}finally{u(!1)}},Le=()=>{N(pe()),N(be()),N(je()),N(ye()),N(ve()),N(_e()),M("/create-deal")},X=r=>{const n=[];r.address_line_1&&n.push(r.address_line_1),r.address_line_2&&n.push(r.address_line_2),r.city&&n.push(r.city),r.post_code&&n.push(r.post_code);const f=n.join(", "),v=120;return f.length>v?f.substring(0,v)+"...":f};ce!=null&&ce.data;const Te=new Date().getFullYear();Array.from({length:4},(r,n)=>Te-n);const Z=async(r,n)=>{var f,v,x,ue,xe,he;if(r)try{g(!0);const $=await rt(r);N(be()),N(je()),N(ye()),N(ve()),N(_e());for(let de=1;de<=n;de++)N({type:`deal/setDealSteps${de}`,payload:!0});N(pe()),console.log("reset edit all deals down",pe);const me=((f=$==null?void 0:$.data)==null?void 0:f.data)||{},Ie=me.propertyDealSaInvestment||me.propertyDealInvestment||{},{id:gt,...Me}=Ie||{},fe=((ue=(x=(v=$==null?void 0:$.data)==null?void 0:v.data)==null?void 0:x.deal)==null?void 0:ue.step_completed)||1,He={...(he=(xe=$==null?void 0:$.data)==null?void 0:xe.data)==null?void 0:he.deal,...Me,step:fe};N(nt(He)),N(at(fe)),M("/create-deal/address?mode=edit")}catch{p("Failed to edit deal. Please try again.","error")}finally{g(!1)}},[Be,$e]=o.useState(!1),{id:ft}=We();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-xl md:text-3xl font-semibold text-dark dark:text-white",children:["Welcome Back, ",mt(w==null?void 0:w.first_name)]}),e.jsxs("button",{onClick:Le,className:"purple-btn flex items-center gap-2",children:[e.jsx("span",{className:"md:hidden",children:e.jsx(ge,{className:"text-2xl text-white"})}),e.jsxs("span",{className:"hidden md:flex items-center gap-2",children:[e.jsx(ge,{className:"text-xl text-white"}),"Create a new deal"]})]})]}),e.jsxs("div",{className:"overflow-x-auto p-0",children:[e.jsx(ot,{isOpen:U,onClose:()=>P(!1),onConfirm:Pe,title:"Delete Deal",isLoading:s}),e.jsx(lt,{isOpen:S,onClose:()=>A(!1),onConfirm:Oe,title:"Archive Deal",isLoading:d}),e.jsx(ke,{isOpen:Be,onClose:()=>{$e(!1),L([])},selectedDeals:k}),e.jsx("div",{className:"deals-assets-grid-wrap my-10",children:Ne.map(({label:r,status:n,icon:f,count:v})=>e.jsxs("div",{className:`deals-assets-grid-col cursor-pointer ${j===n?"!border !border-[#AFB6F2] !bg-[#F6F7FE] !bg-none dark:!bg-none dark:!bg-[#262145] dark:!border-[#6C5DD3]":""}`,onClick:()=>Y(n),children:[e.jsxs("div",{className:"flex justify-between deals-assets-heading mb-7",children:[e.jsx("p",{className:`${j===n?"!bg-[#F6F7FE] border-[#AFB6F2] text-black dark:!bg-[#262145] dark:!border-[#6C5DD3] dark:!text-white":"text-[#595959] dark:text-[#C5C5C5]"} font-medium`,children:r}),e.jsx("span",{className:`${j===n?"text-white":""}`,children:f})]}),e.jsx("h2",{className:`font-medium total-deals-assets ${j===n?"border-purple pb-1":"text-[#242424] dark:text-white"}`,children:v})]},n))}),e.jsx("h3",{className:"light-black font-medium mb-4 dark:text-white",children:"All deals"}),e.jsxs("div",{className:"flex flex-col-reverse md:flex-row justify-between items-start md:items-center mb-6 gap-4 md:gap-0",children:[e.jsx("div",{className:"",children:e.jsxs("ul",{className:"inline-flex flex-wrap deal-types-tabs-wrap gap-6",children:[e.jsx("li",{className:"",children:e.jsx("button",{onClick:()=>_("all"),className:`tab-btn ${a==="all"?"active":""}`,children:"All Deals Types"})}),e.jsx("li",{className:"",children:e.jsxs("button",{onClick:()=>_("sa"),className:`tab-btn ${a==="sa"?"active":""}`,children:[e.jsx("span",{className:"hidden md:inline",children:"Service accommodation (SA)"}),e.jsx("span",{className:"inline md:hidden",children:"SA"})]})}),e.jsx("li",{className:"",children:e.jsxs("button",{onClick:()=>_("hmo"),className:`tab-btn ${a==="hmo"?"active":""}`,children:[e.jsx("span",{className:"hidden md:inline",children:"House in multiple occupation(HMO)"}),e.jsx("span",{className:"inline md:hidden",children:"HMO"})]})}),e.jsx("li",{className:"",children:e.jsx("button",{onClick:()=>_("single_let"),className:`tab-btn ${a==="single_let"?"active":""}`,children:"Single let"})})]})}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 border border-[DADADA]  px-4 py-2 rounded-xl  ",onClick:r=>{r.preventDefault(),Ae()},children:[e.jsx(qe,{className:"text-2xl"}),e.jsx("span",{children:"Share"})]})]}),e.jsxs("div",{className:"total-deal-table-wrapper",children:[e.jsxs("div",{className:"relative custom-input-w my-3 ml-3",children:[e.jsx("input",{type:"text",placeholder:"Search for deals",className:"form-control",value:E,onChange:Ce,style:{paddingLeft:"40px"}}),e.jsx(Je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),c||Se?e.jsx(Ke,{}):e.jsxs("div",{className:"overflow-x-auto dark:bg-[#222632] bg-[#EBEBEC] comparable-listing-table-wrap",children:[a==="all"&&e.jsx(pt,{deals:R,selectedDeals:k,setSelectedDeals:L,handleSelectDeal:G,handleSort:Q,filters:b,pagination:y,handleEditDeal:j==="archive"?K:Z,handleViewDeal:W,openDeleteConfirmation:q,openArchiveConfirmation:J,formatAddress:X,archive:j}),a==="sa"&&e.jsx(ut,{deals:R,selectedDeals:k,setSelectedDeals:L,handleSelectDeal:G,handleSort:Q,filters:b,pagination:y,handleEditDeal:j==="archive"?K:Z,handleViewDeal:W,openDeleteConfirmation:q,formatAddress:X,archive:j,openArchiveConfirmation:J}),a==="hmo"&&e.jsx(ht,{deals:R,selectedDeals:k,setSelectedDeals:L,handleSelectDeal:G,handleSort:Q,filters:b,pagination:y,handleEditDeal:j==="archive"?K:Z,handleViewDeal:W,openDeleteConfirmation:q,openArchiveConfirmation:J,formatAddress:X,archive:j}),a==="single_let"&&e.jsx(xt,{deals:R,selectedDeals:k,setSelectedDeals:L,handleSelectDeal:G,handleSort:Q,filters:b,pagination:y,handleEditDeal:j==="archive"?K:Z,handleViewDeal:W,openArchiveConfirmation:J,openDeleteConfirmation:q,formatAddress:X,archive:j})]})]}),e.jsx(it,{pagination:{total:y.total,currentPage:b.page,perPage:b.per_page>y.total?y.total:b.per_page,totalPages:Math.ceil(y.total/b.per_page)},setFilters:z}),T&&e.jsx(ke,{isOpen:T,onClose:Re,selectedDeals:k})]})]})};export{Nt as default};
