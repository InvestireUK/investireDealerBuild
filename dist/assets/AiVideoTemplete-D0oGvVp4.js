import{s as K,t as M,u as d,r as u,m as e,cJ as O,aJ as R,cK as U,cL as Y,cM as q,cN as V,cO as A,cP as G,bb as H}from"./index-CpEWmEc9.js";const W=()=>{var k,C;const m=K(),j=M(),n=d(s=>s.deal.AiVideoData);d(s=>s.deal.SaveAiData);const y=d(s=>s.deal.VideoScenes),T=d(s=>s.deal.VideoVariables),[z,N]=u.useState(!1),p=d(s=>{var a;return(a=s.deal)==null?void 0:a.deal}),{user:w}=d(s=>s),[x,v]=u.useState(null),g=u.useRef(null),[t,F]=u.useState([]),[i,c]=u.useState(null),[_,h]=u.useState(!1),B=()=>{g.current.scrollBy({left:-200,behavior:"smooth"})},E=()=>{g.current.scrollBy({left:200,behavior:"smooth"})},I=async s=>{try{T&&y&&y.length>0&&(j("/ai-video",{state:{templateId:s}}),h(!1))}catch(a){console.error("API error:",a)}},J=async s=>{var a,l,S,$,L;try{m(V([])),m(A([])),h(!0);const o=(await G({template_id:s,user_id:(a=w.user)==null?void 0:a.id,deal_id:p.id})).data.data.template;F(o),o!=null&&o.video_path&&c({type:"video",src:`https://investier-vision.visionvivante.in/storage/${o.video_path}`}),((l=o==null?void 0:o.image_paths)==null?void 0:l.length)>0&&c({type:"image",src:`https://investier-vision.visionvivante.in/storage/${o.image_paths[0]}`});const b=await H({template_id:s,user_id:(S=w.user)==null?void 0:S.id,deal_id:p.id}),r=($=b==null?void 0:b.data)==null?void 0:$.data,f=r==null?void 0:r.user_subscriptions;if((f==null?void 0:f.ai_video_limit)===0){h(!1),v(null),c(null),N(!0);return}m(V(((L=r==null?void 0:r.template)==null?void 0:L.scenes)||[])),m(A((r==null?void 0:r.variables)||[])),h(!1)}catch(P){console.error("Error updating preference",P),h(!1)}};return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>j(`/deals/deal-view/${p.id}`),className:"flex items-center gap-2 mb-5",children:[e.jsx(O,{})," Back"]}),e.jsx("h4",{className:"font-bold text-3xl",children:"Select a template"}),e.jsx("p",{className:"mb-2 text-[#333333] dark:text-[#F8F8F8]",children:"Select a template to instantly generate your video content."}),n&&(n==null?void 0:n.length)>0?e.jsx("div",{className:"ai-video-grid m-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:n==null?void 0:n.map((s,a)=>e.jsxs("div",{className:"ai-video-card relative group cursor-pointer rounded-lg overflow-hidden shadow-md",children:[e.jsx("img",{src:(s==null?void 0:s.thumbnail_image_url)||R,alt:s==null?void 0:s.name,className:"w-full h-40 object-cover"}),e.jsx("h6",{className:"p-3 text-center font-medium",children:s==null?void 0:s.name}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("button",{className:`flex gap-1 items-center rounded-xl bg-white dark:bg-[#121212] text-[#6C5DD3] font-medium px-4 py-2 
                       opacity-0 translate-y-10 group-hover:opacity-100 group-hover:translate-y-0 
                       transition-all duration-300 ease-out`,onClick:l=>{l.stopPropagation(),v(s),J(s==null?void 0:s.template_id)},children:[e.jsx(U,{})," Preview"]})}),z&&e.jsx("div",{className:"fixed inset-0 flex justify-center items-center z-[9999]",children:e.jsxs("div",{className:"bg-white dark:bg-[#1e1e1e] p-6 rounded-xl w-[350px] text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-600",children:"AI Video Limit Reached"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"You have no remaining AI video credits. Please upgrade your plan to continue."}),e.jsx("button",{onClick:()=>N(!1),className:"mt-4 px-4 py-2 rounded-lg bg-[#6C5DD3] text-white hover:bg-[#5948b5]",children:"OK"})]})})]},a))}):e.jsx("p",{children:"No AI video templates available."}),x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 px-5",children:e.jsxs("div",{className:"bg-white dark:bg-[#121212] rounded-lg shadow-lg w-full max-w-4xl relative p-4 sm:p-6",children:[e.jsx("button",{className:"absolute top-3 right-3 text-gray-600 hover:text-black",onClick:()=>{v(null),c(null)},children:"âœ•"}),e.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 sm:px-10",children:e.jsx("div",{className:"w-full sm:w-[640px] h-[200px] sm:h-[360px] mx-auto flex items-center justify-center rounded-md overflow-hidden",children:i?i.type==="video"?e.jsx("video",{src:i.src,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"},i.src):e.jsx("img",{src:i.src,alt:"Selected preview",className:"w-full h-full object-contain"}):t!=null&&t.video_path?e.jsx("video",{src:`https://investier-vision.visionvivante.in/storage/${t.video_path}`,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"w-full h-full object-contain"},t.video_path):e.jsx("img",{src:(k=t==null?void 0:t.image_paths)!=null&&k[0]?`https://investier-vision.visionvivante.in/storage/${t.image_paths[0]}`:null,alt:t==null?void 0:t.name,className:"w-full h-full object-contain"})})}),e.jsxs("div",{className:"relative mt-4 max-w-3xl mx-auto px-4 sm:px-10",children:[e.jsx("button",{onClick:B,className:"absolute left-0 top-1/2 -translate-y-1/2 shadow rounded-full p-2 bg-white z-10 hidden sm:block dark:bg-[#121212]",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsxs("div",{ref:g,className:"flex gap-2 overflow-x-auto scrollbar-hide px-2 sm:px-8",children:[(t==null?void 0:t.video_path)&&(()=>{const s=`https://investier-vision.visionvivante.in/storage/${t.video_path}`;return e.jsx("video",{src:s,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:`h-16 w-28 sm:h-20 sm:w-32 object-cover rounded cursor-pointer border-2 ${(i==null?void 0:i.type)==="video"&&(i==null?void 0:i.src)===s?"border-blue-500":"border-transparent"}`,onClick:()=>c({type:"video",src:s})})})(),(C=t==null?void 0:t.image_paths)==null?void 0:C.map((s,a)=>{const l=`https://investier-vision.visionvivante.in/storage/${s}`;return e.jsx("img",{src:l,alt:`image-${a}`,className:`h-16 w-28 sm:h-20 sm:w-32 object-cover rounded cursor-pointer border-2 ${(i==null?void 0:i.type)==="image"&&(i==null?void 0:i.src)===l?"border-blue-500":"border-transparent"}`,onClick:()=>c({type:"image",src:l})},a)})]}),e.jsx("button",{onClick:E,className:"absolute right-0 top-1/2 -translate-y-1/2 shadow rounded-full p-2 bg-white z-10 hidden sm:block dark:bg-[#121212]",children:e.jsx(q,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-row justify-end sm:gap-3 mt-6 gap-2",children:[e.jsx("button",{className:"border px-4 py-2 rounded-md w-full sm:w-auto",onClick:()=>{v(null),c(null)},children:"Cancel"}),e.jsx("button",{className:"purple-btn w-full sm:w-auto",onClick:()=>I(x==null?void 0:x.template_id),disabled:_,children:_?"Please wait...":"Use Template"})]})]})})]})};export{W as default};
